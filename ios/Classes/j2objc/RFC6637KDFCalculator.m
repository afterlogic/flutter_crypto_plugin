//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../android/src/main/kotlin/lib/org/bouncycastle/openpgp/operator/RFC6637KDFCalculator.java
//

#include "ASN1ObjectIdentifier.h"
#include "ECFieldElement.h"
#include "ECPoint.h"
#include "Hex.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "PGPDigestCalculator.h"
#include "PGPException.h"
#include "PublicKeyAlgorithmTags.h"
#include "RFC6637KDFCalculator.h"
#include "SymmetricKeyAlgorithmTags.h"
#include "java/io/ByteArrayOutputStream.h"
#include "java/io/IOException.h"
#include "java/io/OutputStream.h"
#include "java/lang/System.h"

@interface LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator () {
 @public
  id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc_;
  jint keyAlgorithm_;
}

+ (IOSByteArray *)KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator:(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>)digCalc
                                          withLibOrgBouncycastleMathEcECPoint:(LibOrgBouncycastleMathEcECPoint *)s
                                                                      withInt:(jint)keyLen
                                                                withByteArray:(IOSByteArray *)param;

+ (jint)getKeyLenWithInt:(jint)algID;

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator, digCalc_, id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>)

inline IOSByteArray *LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_get_ANONYMOUS_SENDER(void);
static IOSByteArray *LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_ANONYMOUS_SENDER;
J2OBJC_STATIC_FIELD_OBJ_FINAL(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator, ANONYMOUS_SENDER, IOSByteArray *)

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withLibOrgBouncycastleMathEcECPoint_withInt_withByteArray_(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc, LibOrgBouncycastleMathEcECPoint *s, jint keyLen, IOSByteArray *param);

__attribute__((unused)) static jint LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_getKeyLenWithInt_(jint algID);

J2OBJC_INITIALIZED_DEFN(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator)

@implementation LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator

- (instancetype)initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator:(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>)digCalc
                                                                     withInt:(jint)keyAlgorithm {
  LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_(self, digCalc, keyAlgorithm);
  return self;
}

- (IOSByteArray *)createKeyWithLibOrgBouncycastleAsn1ASN1ObjectIdentifier:(LibOrgBouncycastleAsn1ASN1ObjectIdentifier *)curveOID
                                      withLibOrgBouncycastleMathEcECPoint:(LibOrgBouncycastleMathEcECPoint *)s
                                                            withByteArray:(IOSByteArray *)recipientFingerPrint {
  @try {
    JavaIoByteArrayOutputStream *pOut = new_JavaIoByteArrayOutputStream_init();
    IOSByteArray *encOid = [((LibOrgBouncycastleAsn1ASN1ObjectIdentifier *) nil_chk(curveOID)) getEncoded];
    [pOut writeWithByteArray:encOid withInt:1 withInt:((IOSByteArray *) nil_chk(encOid))->size_ - 1];
    [pOut writeWithInt:LibOrgBouncycastleBcpgPublicKeyAlgorithmTags_ECDH];
    [pOut writeWithInt:(jint) 0x03];
    [pOut writeWithInt:(jint) 0x01];
    [pOut writeWithInt:[((id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>) nil_chk(digCalc_)) getAlgorithm]];
    [pOut writeWithInt:keyAlgorithm_];
    [pOut writeWithByteArray:LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_ANONYMOUS_SENDER];
    [pOut writeWithByteArray:recipientFingerPrint];
    return LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withLibOrgBouncycastleMathEcECPoint_withInt_withByteArray_(digCalc_, s, LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_getKeyLenWithInt_(keyAlgorithm_), [pOut toByteArray]);
  }
  @catch (JavaIoIOException *e) {
    @throw new_LibOrgBouncycastleOpenpgpPGPException_initWithNSString_withJavaLangException_(JreStrcat("$$", @"Exception performing KDF: ", [e getMessage]), e);
  }
}

+ (IOSByteArray *)KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator:(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>)digCalc
                                          withLibOrgBouncycastleMathEcECPoint:(LibOrgBouncycastleMathEcECPoint *)s
                                                                      withInt:(jint)keyLen
                                                                withByteArray:(IOSByteArray *)param {
  return LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withLibOrgBouncycastleMathEcECPoint_withInt_withByteArray_(digCalc, s, keyLen, param);
}

+ (jint)getKeyLenWithInt:(jint)algID {
  return LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_getKeyLenWithInt_(algID);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, 1, 2, 3, -1, -1, -1 },
    { NULL, "[B", 0xa, 4, 5, 6, -1, -1, -1 },
    { NULL, "I", 0xa, 7, 8, 3, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator:withInt:);
  methods[1].selector = @selector(createKeyWithLibOrgBouncycastleAsn1ASN1ObjectIdentifier:withLibOrgBouncycastleMathEcECPoint:withByteArray:);
  methods[2].selector = @selector(KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator:withLibOrgBouncycastleMathEcECPoint:withInt:withByteArray:);
  methods[3].selector = @selector(getKeyLenWithInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "ANONYMOUS_SENDER", "[B", .constantValue.asLong = 0, 0x1a, -1, 9, -1, -1 },
    { "digCalc_", "LLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "keyAlgorithm_", "I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator;I", "createKey", "LLibOrgBouncycastleAsn1ASN1ObjectIdentifier;LLibOrgBouncycastleMathEcECPoint;[B", "LLibOrgBouncycastleOpenpgpPGPException;", "KDF", "LLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator;LLibOrgBouncycastleMathEcECPoint;I[B", "LJavaIoIOException;", "getKeyLen", "I", &LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_ANONYMOUS_SENDER };
  static const J2ObjcClassInfo _LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator = { "RFC6637KDFCalculator", "lib.org.bouncycastle.openpgp.operator", ptrTable, methods, fields, 7, 0x1, 4, 3, -1, -1, -1, -1, -1 };
  return &_LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator;
}

+ (void)initialize {
  if (self == [LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator class]) {
    LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_ANONYMOUS_SENDER = LibOrgBouncycastleUtilEncodersHex_decodeWithNSString_(@"416E6F6E796D6F75732053656E64657220202020");
    J2OBJC_SET_INITIALIZED(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator)
  }
}

@end

void LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator *self, id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc, jint keyAlgorithm) {
  NSObject_init(self);
  self->digCalc_ = digCalc;
  self->keyAlgorithm_ = keyAlgorithm;
}

LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator *new_LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc, jint keyAlgorithm) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator, initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_, digCalc, keyAlgorithm)
}

LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator *create_LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc, jint keyAlgorithm) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator, initWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withInt_, digCalc, keyAlgorithm)
}

IOSByteArray *LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_KDFWithLibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator_withLibOrgBouncycastleMathEcECPoint_withInt_withByteArray_(id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator> digCalc, LibOrgBouncycastleMathEcECPoint *s, jint keyLen, IOSByteArray *param) {
  LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initialize();
  IOSByteArray *ZB = [((LibOrgBouncycastleMathEcECFieldElement *) nil_chk([((LibOrgBouncycastleMathEcECPoint *) nil_chk(s)) getXCoord])) getEncoded];
  JavaIoOutputStream *dOut = [((id<LibOrgBouncycastleOpenpgpOperatorPGPDigestCalculator>) nil_chk(digCalc)) getOutputStream];
  [((JavaIoOutputStream *) nil_chk(dOut)) writeWithInt:(jint) 0x00];
  [dOut writeWithInt:(jint) 0x00];
  [dOut writeWithInt:(jint) 0x00];
  [dOut writeWithInt:(jint) 0x01];
  [dOut writeWithByteArray:ZB];
  [dOut writeWithByteArray:param];
  IOSByteArray *digest = [digCalc getDigest];
  IOSByteArray *key = [IOSByteArray newArrayWithLength:keyLen];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(digest, 0, key, 0, key->size_);
  return key;
}

jint LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_getKeyLenWithInt_(jint algID) {
  LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator_initialize();
  switch (algID) {
    case LibOrgBouncycastleBcpgSymmetricKeyAlgorithmTags_AES_128:
    return 16;
    case LibOrgBouncycastleBcpgSymmetricKeyAlgorithmTags_AES_192:
    return 24;
    case LibOrgBouncycastleBcpgSymmetricKeyAlgorithmTags_AES_256:
    return 32;
    default:
    @throw new_LibOrgBouncycastleOpenpgpPGPException_initWithNSString_(JreStrcat("$I", @"unknown symmetric algorithm ID: ", algID));
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastleOpenpgpOperatorRFC6637KDFCalculator)
