//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../android/src/main/kotlin/lib/org/bouncycastle/pqc/crypto/gmss/GMSSPrivateKeyParameters.java
//

#include "Arrays.h"
#include "Digest.h"
#include "GMSSDigestProvider.h"
#include "GMSSKeyParameters.h"
#include "GMSSLeaf.h"
#include "GMSSParameters.h"
#include "GMSSPrivateKeyParameters.h"
#include "GMSSRandom.h"
#include "GMSSRootCalc.h"
#include "GMSSRootSig.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "Treehash.h"
#include "WinternitzOTSignature.h"
#include "java/io/PrintStream.h"
#include "java/lang/Exception.h"
#include "java/lang/Math.h"
#include "java/lang/System.h"
#include "java/util/Vector.h"

@interface LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters () {
 @public
  IOSIntArray *index_;
  IOSObjectArray *currentSeeds_;
  IOSObjectArray *nextNextSeeds_;
  IOSObjectArray *currentAuthPaths_;
  IOSObjectArray *nextAuthPaths_;
  IOSObjectArray *currentTreehash_;
  IOSObjectArray *nextTreehash_;
  IOSObjectArray *currentStack_;
  IOSObjectArray *nextStack_;
  IOSObjectArray *currentRetain_;
  IOSObjectArray *nextRetain_;
  IOSObjectArray *keep_;
  IOSObjectArray *nextNextLeaf_;
  IOSObjectArray *upperLeaf_;
  IOSObjectArray *upperTreehashLeaf_;
  IOSIntArray *minTreehash_;
  LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssPS_;
  IOSObjectArray *nextRoot_;
  IOSObjectArray *nextNextRoot_;
  IOSObjectArray *currentRootSig_;
  IOSObjectArray *nextRootSig_;
  id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider_;
  jboolean used_;
  IOSIntArray *heightOfTrees_;
  IOSIntArray *otsIndex_;
  IOSIntArray *K_;
  jint numLayer_;
  id<LibOrgBouncycastleCryptoDigest> messDigestTrees_;
  jint mdLength_;
  LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *gmssRandom_;
  IOSIntArray *numLeafs_;
}

- (instancetype)initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters:(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *)original;

- (void)nextKeyWithInt:(jint)layer;

- (void)nextTreeWithInt:(jint)layer;

- (void)updateKeyWithInt:(jint)layer;

- (jint)getMinTreehashIndexWithInt:(jint)layer;

- (void)computeAuthPathsWithInt:(jint)layer;

- (jint)heightOfPhiWithInt:(jint)Phi;

- (void)updateNextNextAuthRootWithInt:(jint)layer;

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, index_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentSeeds_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextNextSeeds_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentAuthPaths_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextAuthPaths_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentTreehash_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextTreehash_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentStack_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextStack_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentRetain_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextRetain_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, keep_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextNextLeaf_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, upperLeaf_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, upperTreehashLeaf_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, minTreehash_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, gmssPS_, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextRoot_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextNextRoot_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, currentRootSig_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, nextRootSig_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, digestProvider_, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, heightOfTrees_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, otsIndex_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, K_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, messDigestTrees_, id<LibOrgBouncycastleCryptoDigest>)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, gmssRandom_, LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, numLeafs_, IOSIntArray *)

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original);

__attribute__((unused)) static LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *new_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original) NS_RETURNS_RETAINED;

__attribute__((unused)) static LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *create_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextKeyWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextTreeWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateKeyWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

__attribute__((unused)) static jint LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_computeAuthPathsWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

__attribute__((unused)) static jint LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_heightOfPhiWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint Phi);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateNextNextAuthRootWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer);

@implementation LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters

- (instancetype)initWithByteArray2:(IOSObjectArray *)currentSeed
                    withByteArray2:(IOSObjectArray *)nextNextSeed
                    withByteArray3:(IOSObjectArray *)currentAuthPath
                    withByteArray3:(IOSObjectArray *)nextAuthPath
withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:(IOSObjectArray *)currentTreehash
withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:(IOSObjectArray *)nextTreehash
           withJavaUtilVectorArray:(IOSObjectArray *)currentStack
           withJavaUtilVectorArray:(IOSObjectArray *)nextStack
          withJavaUtilVectorArray2:(IOSObjectArray *)currentRetain
          withJavaUtilVectorArray2:(IOSObjectArray *)nextRetain
                    withByteArray2:(IOSObjectArray *)nextRoot
                    withByteArray2:(IOSObjectArray *)currentRootSig
withLibOrgBouncycastlePqcCryptoGmssGMSSParameters:(LibOrgBouncycastlePqcCryptoGmssGMSSParameters *)gmssParameterset
withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider:(id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>)digestProvider {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(self, currentSeed, nextNextSeed, currentAuthPath, nextAuthPath, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextRoot, currentRootSig, gmssParameterset, digestProvider);
  return self;
}

- (instancetype)initWithIntArray:(IOSIntArray *)index
                  withByteArray2:(IOSObjectArray *)currentSeeds
                  withByteArray2:(IOSObjectArray *)nextNextSeeds
                  withByteArray3:(IOSObjectArray *)currentAuthPaths
                  withByteArray3:(IOSObjectArray *)nextAuthPaths
                  withByteArray3:(IOSObjectArray *)keep
withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:(IOSObjectArray *)currentTreehash
withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:(IOSObjectArray *)nextTreehash
         withJavaUtilVectorArray:(IOSObjectArray *)currentStack
         withJavaUtilVectorArray:(IOSObjectArray *)nextStack
        withJavaUtilVectorArray2:(IOSObjectArray *)currentRetain
        withJavaUtilVectorArray2:(IOSObjectArray *)nextRetain
withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:(IOSObjectArray *)nextNextLeaf
withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:(IOSObjectArray *)upperLeaf
withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:(IOSObjectArray *)upperTreehashLeaf
                    withIntArray:(IOSIntArray *)minTreehash
                  withByteArray2:(IOSObjectArray *)nextRoot
withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray:(IOSObjectArray *)nextNextRoot
                  withByteArray2:(IOSObjectArray *)currentRootSig
withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray:(IOSObjectArray *)nextRootSig
withLibOrgBouncycastlePqcCryptoGmssGMSSParameters:(LibOrgBouncycastlePqcCryptoGmssGMSSParameters *)gmssParameterset
withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider:(id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>)digestProvider {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(self, index, currentSeeds, nextNextSeeds, currentAuthPaths, nextAuthPaths, keep, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextNextLeaf, upperLeaf, upperTreehashLeaf, minTreehash, nextRoot, nextNextRoot, currentRootSig, nextRootSig, gmssParameterset, digestProvider);
  return self;
}

- (instancetype)initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters:(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *)original {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(self, original);
  return self;
}

- (jboolean)isUsed {
  return self->used_;
}

- (void)markUsed {
  self->used_ = true;
}

- (LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *)nextKey {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *nKey = new_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(self);
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextKeyWithInt_(nKey, [((LibOrgBouncycastlePqcCryptoGmssGMSSParameters *) nil_chk(gmssPS_)) getNumOfLayers] - 1);
  return nKey;
}

- (void)nextKeyWithInt:(jint)layer {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextKeyWithInt_(self, layer);
}

- (void)nextTreeWithInt:(jint)layer {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextTreeWithInt_(self, layer);
}

- (void)updateKeyWithInt:(jint)layer {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateKeyWithInt_(self, layer);
}

- (jint)getMinTreehashIndexWithInt:(jint)layer {
  return LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(self, layer);
}

- (void)computeAuthPathsWithInt:(jint)layer {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_computeAuthPathsWithInt_(self, layer);
}

- (jint)heightOfPhiWithInt:(jint)Phi {
  return LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_heightOfPhiWithInt_(self, Phi);
}

- (void)updateNextNextAuthRootWithInt:(jint)layer {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateNextNextAuthRootWithInt_(self, layer);
}

- (IOSIntArray *)getIndex {
  return index_;
}

- (jint)getIndexWithInt:(jint)i {
  return IOSIntArray_Get(nil_chk(index_), i);
}

- (IOSObjectArray *)getCurrentSeeds {
  return LibOrgBouncycastleUtilArrays_cloneWithByteArray2_(currentSeeds_);
}

- (IOSObjectArray *)getCurrentAuthPaths {
  return LibOrgBouncycastleUtilArrays_cloneWithByteArray3_(currentAuthPaths_);
}

- (IOSByteArray *)getSubtreeRootSigWithInt:(jint)i {
  return IOSObjectArray_Get(nil_chk(currentRootSig_), i);
}

- (id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>)getName {
  return digestProvider_;
}

- (jint)getNumLeafsWithInt:(jint)i {
  return IOSIntArray_Get(nil_chk(numLeafs_), i);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 1, -1, -1, -1, -1 },
    { NULL, NULL, 0x2, -1, 2, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 3, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 5, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 6, 4, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 7, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 8, 4, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 9, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 10, 4, -1, -1, -1, -1 },
    { NULL, "[I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, 11, 4, -1, -1, -1, -1 },
    { NULL, "[[B", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "[[[B", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, 12, 4, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, 13, 4, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithByteArray2:withByteArray2:withByteArray3:withByteArray3:withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:withJavaUtilVectorArray:withJavaUtilVectorArray:withJavaUtilVectorArray2:withJavaUtilVectorArray2:withByteArray2:withByteArray2:withLibOrgBouncycastlePqcCryptoGmssGMSSParameters:withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider:);
  methods[1].selector = @selector(initWithIntArray:withByteArray2:withByteArray2:withByteArray3:withByteArray3:withByteArray3:withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:withLibOrgBouncycastlePqcCryptoGmssTreehashArray2:withJavaUtilVectorArray:withJavaUtilVectorArray:withJavaUtilVectorArray2:withJavaUtilVectorArray2:withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray:withIntArray:withByteArray2:withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray:withByteArray2:withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray:withLibOrgBouncycastlePqcCryptoGmssGMSSParameters:withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider:);
  methods[2].selector = @selector(initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters:);
  methods[3].selector = @selector(isUsed);
  methods[4].selector = @selector(markUsed);
  methods[5].selector = @selector(nextKey);
  methods[6].selector = @selector(nextKeyWithInt:);
  methods[7].selector = @selector(nextTreeWithInt:);
  methods[8].selector = @selector(updateKeyWithInt:);
  methods[9].selector = @selector(getMinTreehashIndexWithInt:);
  methods[10].selector = @selector(computeAuthPathsWithInt:);
  methods[11].selector = @selector(heightOfPhiWithInt:);
  methods[12].selector = @selector(updateNextNextAuthRootWithInt:);
  methods[13].selector = @selector(getIndex);
  methods[14].selector = @selector(getIndexWithInt:);
  methods[15].selector = @selector(getCurrentSeeds);
  methods[16].selector = @selector(getCurrentAuthPaths);
  methods[17].selector = @selector(getSubtreeRootSigWithInt:);
  methods[18].selector = @selector(getName);
  methods[19].selector = @selector(getNumLeafsWithInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "index_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentSeeds_", "[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextNextSeeds_", "[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentAuthPaths_", "[[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextAuthPaths_", "[[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentTreehash_", "[[LLibOrgBouncycastlePqcCryptoGmssTreehash;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextTreehash_", "[[LLibOrgBouncycastlePqcCryptoGmssTreehash;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentStack_", "[LJavaUtilVector;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextStack_", "[LJavaUtilVector;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentRetain_", "[[LJavaUtilVector;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextRetain_", "[[LJavaUtilVector;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "keep_", "[[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextNextLeaf_", "[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "upperLeaf_", "[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "upperTreehashLeaf_", "[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "minTreehash_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "gmssPS_", "LLibOrgBouncycastlePqcCryptoGmssGMSSParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextRoot_", "[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextNextRoot_", "[LLibOrgBouncycastlePqcCryptoGmssGMSSRootCalc;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentRootSig_", "[[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "nextRootSig_", "[LLibOrgBouncycastlePqcCryptoGmssGMSSRootSig;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "digestProvider_", "LLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "used_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "heightOfTrees_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "otsIndex_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "K_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "numLayer_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "messDigestTrees_", "LLibOrgBouncycastleCryptoDigest;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "mdLength_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "gmssRandom_", "LLibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "numLeafs_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "[[B[[B[[[B[[[B[[LLibOrgBouncycastlePqcCryptoGmssTreehash;[[LLibOrgBouncycastlePqcCryptoGmssTreehash;[LJavaUtilVector;[LJavaUtilVector;[[LJavaUtilVector;[[LJavaUtilVector;[[B[[BLLibOrgBouncycastlePqcCryptoGmssGMSSParameters;LLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider;", "[I[[B[[B[[[B[[[B[[[B[[LLibOrgBouncycastlePqcCryptoGmssTreehash;[[LLibOrgBouncycastlePqcCryptoGmssTreehash;[LJavaUtilVector;[LJavaUtilVector;[[LJavaUtilVector;[[LJavaUtilVector;[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;[LLibOrgBouncycastlePqcCryptoGmssGMSSLeaf;[I[[B[LLibOrgBouncycastlePqcCryptoGmssGMSSRootCalc;[[B[LLibOrgBouncycastlePqcCryptoGmssGMSSRootSig;LLibOrgBouncycastlePqcCryptoGmssGMSSParameters;LLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider;", "LLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters;", "nextKey", "I", "nextTree", "updateKey", "getMinTreehashIndex", "computeAuthPaths", "heightOfPhi", "updateNextNextAuthRoot", "getIndex", "getSubtreeRootSig", "getNumLeafs" };
  static const J2ObjcClassInfo _LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters = { "GMSSPrivateKeyParameters", "lib.org.bouncycastle.pqc.crypto.gmss", ptrTable, methods, fields, 7, 0x1, 20, 31, -1, -1, -1, -1, -1 };
  return &_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters;
}

@end

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, IOSObjectArray *currentSeed, IOSObjectArray *nextNextSeed, IOSObjectArray *currentAuthPath, IOSObjectArray *nextAuthPath, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextRoot, IOSObjectArray *currentRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(self, nil, currentSeed, nextNextSeed, currentAuthPath, nextAuthPath, nil, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nil, nil, nil, nil, nextRoot, nil, currentRootSig, nil, gmssParameterset, digestProvider);
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *new_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(IOSObjectArray *currentSeed, IOSObjectArray *nextNextSeed, IOSObjectArray *currentAuthPath, IOSObjectArray *nextAuthPath, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextRoot, IOSObjectArray *currentRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_, currentSeed, nextNextSeed, currentAuthPath, nextAuthPath, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextRoot, currentRootSig, gmssParameterset, digestProvider)
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *create_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(IOSObjectArray *currentSeed, IOSObjectArray *nextNextSeed, IOSObjectArray *currentAuthPath, IOSObjectArray *nextAuthPath, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextRoot, IOSObjectArray *currentRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithByteArray2_withByteArray2_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withByteArray2_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_, currentSeed, nextNextSeed, currentAuthPath, nextAuthPath, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextRoot, currentRootSig, gmssParameterset, digestProvider)
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, IOSIntArray *index, IOSObjectArray *currentSeeds, IOSObjectArray *nextNextSeeds, IOSObjectArray *currentAuthPaths, IOSObjectArray *nextAuthPaths, IOSObjectArray *keep, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextNextLeaf, IOSObjectArray *upperLeaf, IOSObjectArray *upperTreehashLeaf, IOSIntArray *minTreehash, IOSObjectArray *nextRoot, IOSObjectArray *nextNextRoot, IOSObjectArray *currentRootSig, IOSObjectArray *nextRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  LibOrgBouncycastlePqcCryptoGmssGMSSKeyParameters_initWithBoolean_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_(self, true, gmssParameterset);
  self->used_ = false;
  self->messDigestTrees_ = [((id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>) nil_chk(digestProvider)) get];
  self->mdLength_ = [((id<LibOrgBouncycastleCryptoDigest>) nil_chk(self->messDigestTrees_)) getDigestSize];
  self->gmssPS_ = gmssParameterset;
  self->otsIndex_ = [((LibOrgBouncycastlePqcCryptoGmssGMSSParameters *) nil_chk(gmssParameterset)) getWinternitzParameter];
  self->K_ = [gmssParameterset getK];
  self->heightOfTrees_ = [gmssParameterset getHeightOfTrees];
  self->numLayer_ = [((LibOrgBouncycastlePqcCryptoGmssGMSSParameters *) nil_chk(self->gmssPS_)) getNumOfLayers];
  if (index == nil) {
    self->index_ = [IOSIntArray newArrayWithLength:self->numLayer_];
    for (jint i = 0; i < self->numLayer_; i++) {
      *IOSIntArray_GetRef(self->index_, i) = 0;
    }
  }
  else {
    self->index_ = index;
  }
  self->currentSeeds_ = currentSeeds;
  self->nextNextSeeds_ = nextNextSeeds;
  self->currentAuthPaths_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray3_(currentAuthPaths);
  self->nextAuthPaths_ = nextAuthPaths;
  if (keep == nil) {
    self->keep_ = [IOSObjectArray newArrayWithLength:self->numLayer_ type:IOSClass_byteArray(2)];
    for (jint i = 0; i < self->numLayer_; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->keep_), i, [IOSByteArray newArrayWithDimensions:2 lengths:(jint[]){ JreFpToInt(JavaLangMath_floorWithDouble_(IOSIntArray_Get(nil_chk(self->heightOfTrees_), i) / 2)), self->mdLength_ }]);
    }
  }
  else {
    self->keep_ = keep;
  }
  if (currentStack == nil) {
    self->currentStack_ = [IOSObjectArray newArrayWithLength:self->numLayer_ type:JavaUtilVector_class_()];
    for (jint i = 0; i < self->numLayer_; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->currentStack_), i, new_JavaUtilVector_init());
    }
  }
  else {
    self->currentStack_ = currentStack;
  }
  if (nextStack == nil) {
    self->nextStack_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 1 type:JavaUtilVector_class_()];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->nextStack_), i, new_JavaUtilVector_init());
    }
  }
  else {
    self->nextStack_ = nextStack;
  }
  self->currentTreehash_ = currentTreehash;
  self->nextTreehash_ = nextTreehash;
  self->currentRetain_ = currentRetain;
  self->nextRetain_ = nextRetain;
  self->nextRoot_ = nextRoot;
  self->digestProvider_ = digestProvider;
  if (nextNextRoot == nil) {
    self->nextNextRoot_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 1 type:LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc_class_()];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->nextNextRoot_), i, new_LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc_initWithInt_withInt_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(IOSIntArray_Get(nil_chk(self->heightOfTrees_), i + 1), IOSIntArray_Get(nil_chk(self->K_), i + 1), self->digestProvider_));
    }
  }
  else {
    self->nextNextRoot_ = nextNextRoot;
  }
  self->currentRootSig_ = currentRootSig;
  self->numLeafs_ = [IOSIntArray newArrayWithLength:self->numLayer_];
  for (jint i = 0; i < self->numLayer_; i++) {
    *IOSIntArray_GetRef(self->numLeafs_, i) = JreLShift32(1, IOSIntArray_Get(nil_chk(self->heightOfTrees_), i));
  }
  self->gmssRandom_ = new_LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom_initWithLibOrgBouncycastleCryptoDigest_(self->messDigestTrees_);
  if (self->numLayer_ > 1) {
    if (nextNextLeaf == nil) {
      self->nextNextLeaf_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 2 type:LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_class_()];
      for (jint i = 0; i < self->numLayer_ - 2; i++) {
        (void) IOSObjectArray_SetAndConsume(nil_chk(self->nextNextLeaf_), i, new_LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_initWithLibOrgBouncycastleCryptoDigest_withInt_withInt_withByteArray_([digestProvider get], IOSIntArray_Get(nil_chk(self->otsIndex_), i + 1), IOSIntArray_Get(nil_chk(self->numLeafs_), i + 2), IOSObjectArray_Get(nil_chk(self->nextNextSeeds_), i)));
      }
    }
    else {
      self->nextNextLeaf_ = nextNextLeaf;
    }
  }
  else {
    self->nextNextLeaf_ = [IOSObjectArray newArrayWithLength:0 type:LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_class_()];
  }
  if (upperLeaf == nil) {
    self->upperLeaf_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 1 type:LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_class_()];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->upperLeaf_), i, new_LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_initWithLibOrgBouncycastleCryptoDigest_withInt_withInt_withByteArray_([digestProvider get], IOSIntArray_Get(nil_chk(self->otsIndex_), i), IOSIntArray_Get(nil_chk(self->numLeafs_), i + 1), IOSObjectArray_Get(nil_chk(self->currentSeeds_), i)));
    }
  }
  else {
    self->upperLeaf_ = upperLeaf;
  }
  if (upperTreehashLeaf == nil) {
    self->upperTreehashLeaf_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 1 type:LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_class_()];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->upperTreehashLeaf_), i, new_LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_initWithLibOrgBouncycastleCryptoDigest_withInt_withInt_([digestProvider get], IOSIntArray_Get(nil_chk(self->otsIndex_), i), IOSIntArray_Get(nil_chk(self->numLeafs_), i + 1)));
    }
  }
  else {
    self->upperTreehashLeaf_ = upperTreehashLeaf;
  }
  if (minTreehash == nil) {
    self->minTreehash_ = [IOSIntArray newArrayWithLength:self->numLayer_ - 1];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      *IOSIntArray_GetRef(self->minTreehash_, i) = -1;
    }
  }
  else {
    self->minTreehash_ = minTreehash;
  }
  IOSByteArray *dummy = [IOSByteArray newArrayWithLength:self->mdLength_];
  IOSByteArray *OTSseed = [IOSByteArray newArrayWithLength:self->mdLength_];
  if (nextRootSig == nil) {
    self->nextRootSig_ = [IOSObjectArray newArrayWithLength:self->numLayer_ - 1 type:LibOrgBouncycastlePqcCryptoGmssGMSSRootSig_class_()];
    for (jint i = 0; i < self->numLayer_ - 1; i++) {
      JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(currentSeeds), i), 0, dummy, 0, self->mdLength_);
      (void) [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      (void) IOSObjectArray_SetAndConsume(nil_chk(self->nextRootSig_), i, new_LibOrgBouncycastlePqcCryptoGmssGMSSRootSig_initWithLibOrgBouncycastleCryptoDigest_withInt_withInt_([digestProvider get], IOSIntArray_Get(nil_chk(self->otsIndex_), i), IOSIntArray_Get(nil_chk(self->heightOfTrees_), i + 1)));
      [((LibOrgBouncycastlePqcCryptoGmssGMSSRootSig *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextRootSig_), i))) initSignWithByteArray:OTSseed withByteArray:IOSObjectArray_Get(nil_chk(nextRoot), i)];
    }
  }
  else {
    self->nextRootSig_ = nextRootSig;
  }
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *new_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(IOSIntArray *index, IOSObjectArray *currentSeeds, IOSObjectArray *nextNextSeeds, IOSObjectArray *currentAuthPaths, IOSObjectArray *nextAuthPaths, IOSObjectArray *keep, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextNextLeaf, IOSObjectArray *upperLeaf, IOSObjectArray *upperTreehashLeaf, IOSIntArray *minTreehash, IOSObjectArray *nextRoot, IOSObjectArray *nextNextRoot, IOSObjectArray *currentRootSig, IOSObjectArray *nextRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_, index, currentSeeds, nextNextSeeds, currentAuthPaths, nextAuthPaths, keep, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextNextLeaf, upperLeaf, upperTreehashLeaf, minTreehash, nextRoot, nextNextRoot, currentRootSig, nextRootSig, gmssParameterset, digestProvider)
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *create_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_(IOSIntArray *index, IOSObjectArray *currentSeeds, IOSObjectArray *nextNextSeeds, IOSObjectArray *currentAuthPaths, IOSObjectArray *nextAuthPaths, IOSObjectArray *keep, IOSObjectArray *currentTreehash, IOSObjectArray *nextTreehash, IOSObjectArray *currentStack, IOSObjectArray *nextStack, IOSObjectArray *currentRetain, IOSObjectArray *nextRetain, IOSObjectArray *nextNextLeaf, IOSObjectArray *upperLeaf, IOSObjectArray *upperTreehashLeaf, IOSIntArray *minTreehash, IOSObjectArray *nextRoot, IOSObjectArray *nextNextRoot, IOSObjectArray *currentRootSig, IOSObjectArray *nextRootSig, LibOrgBouncycastlePqcCryptoGmssGMSSParameters *gmssParameterset, id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider> digestProvider) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithIntArray_withByteArray2_withByteArray2_withByteArray3_withByteArray3_withByteArray3_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withLibOrgBouncycastlePqcCryptoGmssTreehashArray2_withJavaUtilVectorArray_withJavaUtilVectorArray_withJavaUtilVectorArray2_withJavaUtilVectorArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withLibOrgBouncycastlePqcCryptoGmssGMSSLeafArray_withIntArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootCalcArray_withByteArray2_withLibOrgBouncycastlePqcCryptoGmssGMSSRootSigArray_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_withLibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider_, index, currentSeeds, nextNextSeeds, currentAuthPaths, nextAuthPaths, keep, currentTreehash, nextTreehash, currentStack, nextStack, currentRetain, nextRetain, nextNextLeaf, upperLeaf, upperTreehashLeaf, minTreehash, nextRoot, nextNextRoot, currentRootSig, nextRootSig, gmssParameterset, digestProvider)
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original) {
  LibOrgBouncycastlePqcCryptoGmssGMSSKeyParameters_initWithBoolean_withLibOrgBouncycastlePqcCryptoGmssGMSSParameters_(self, true, [((LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *) nil_chk(original)) getParameters]);
  self->used_ = false;
  self->index_ = LibOrgBouncycastleUtilArrays_cloneWithIntArray_(original->index_);
  self->currentSeeds_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray2_(original->currentSeeds_);
  self->nextNextSeeds_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray2_(original->nextNextSeeds_);
  self->currentAuthPaths_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray3_(original->currentAuthPaths_);
  self->nextAuthPaths_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray3_(original->nextAuthPaths_);
  self->currentTreehash_ = original->currentTreehash_;
  self->nextTreehash_ = original->nextTreehash_;
  self->currentStack_ = original->currentStack_;
  self->nextStack_ = original->nextStack_;
  self->currentRetain_ = original->currentRetain_;
  self->nextRetain_ = original->nextRetain_;
  self->keep_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray3_(original->keep_);
  self->nextNextLeaf_ = original->nextNextLeaf_;
  self->upperLeaf_ = original->upperLeaf_;
  self->upperTreehashLeaf_ = original->upperTreehashLeaf_;
  self->minTreehash_ = original->minTreehash_;
  self->gmssPS_ = original->gmssPS_;
  self->nextRoot_ = LibOrgBouncycastleUtilArrays_cloneWithByteArray2_(original->nextRoot_);
  self->nextNextRoot_ = original->nextNextRoot_;
  self->currentRootSig_ = original->currentRootSig_;
  self->nextRootSig_ = original->nextRootSig_;
  self->digestProvider_ = original->digestProvider_;
  self->heightOfTrees_ = original->heightOfTrees_;
  self->otsIndex_ = original->otsIndex_;
  self->K_ = original->K_;
  self->numLayer_ = original->numLayer_;
  self->messDigestTrees_ = original->messDigestTrees_;
  self->mdLength_ = original->mdLength_;
  self->gmssRandom_ = original->gmssRandom_;
  self->numLeafs_ = original->numLeafs_;
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *new_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_, original)
}

LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *create_LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *original) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters, initWithLibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_, original)
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextKeyWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  if (layer == self->numLayer_ - 1) {
    (*IOSIntArray_GetRef(nil_chk(self->index_), layer))++;
  }
  if (IOSIntArray_Get(nil_chk(self->index_), layer) == IOSIntArray_Get(nil_chk(self->numLeafs_), layer)) {
    if (self->numLayer_ != 1) {
      LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextTreeWithInt_(self, layer);
      *IOSIntArray_GetRef(nil_chk(self->index_), layer) = 0;
    }
  }
  else {
    LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateKeyWithInt_(self, layer);
  }
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextTreeWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  if (layer > 0) {
    (*IOSIntArray_GetRef(nil_chk(self->index_), layer - 1))++;
    jboolean lastTree = true;
    jint z = layer;
    do {
      z--;
      if (IOSIntArray_Get(self->index_, z) < IOSIntArray_Get(nil_chk(self->numLeafs_), z)) {
        lastTree = false;
      }
    }
    while (lastTree && (z > 0));
    if (!lastTree) {
      (void) [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:IOSObjectArray_Get(nil_chk(self->currentSeeds_), layer)];
      [((LibOrgBouncycastlePqcCryptoGmssGMSSRootSig *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextRootSig_), layer - 1))) updateSign];
      if (layer > 1) {
        (void) IOSObjectArray_Set(nil_chk(self->nextNextLeaf_), layer - 1 - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->nextNextLeaf_, layer - 1 - 1))) nextLeaf]);
      }
      (void) IOSObjectArray_Set(nil_chk(self->upperLeaf_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->upperLeaf_, layer - 1))) nextLeaf]);
      if (IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1) >= 0) {
        (void) IOSObjectArray_Set(nil_chk(self->upperTreehashLeaf_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->upperTreehashLeaf_, layer - 1))) nextLeaf]);
        IOSByteArray *leaf = [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->upperTreehashLeaf_), layer - 1))) getLeaf];
        @try {
          [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer - 1)), IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1)))) updateWithLibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom:self->gmssRandom_ withByteArray:leaf];
          if ([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer - 1)), IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1)))) wasFinished]) {
          }
        }
        @catch (JavaLangException *e) {
          [((JavaIoPrintStream *) nil_chk(JreLoadStatic(JavaLangSystem, out))) printlnWithId:e];
        }
      }
      LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateNextNextAuthRootWithInt_(self, layer);
      (void) IOSObjectArray_Set(nil_chk(self->currentRootSig_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSRootSig *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextRootSig_), layer - 1))) getSig]);
      for (jint i = 0; i < IOSIntArray_Get(nil_chk(self->heightOfTrees_), layer) - IOSIntArray_Get(nil_chk(self->K_), layer); i++) {
        (void) IOSObjectArray_Set(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->nextTreehash_), layer - 1)), i));
        (void) IOSObjectArray_Set(nil_chk(IOSObjectArray_Get(self->nextTreehash_, layer - 1)), i, IOSObjectArray_Get(nil_chk([((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) getTreehash]), i));
      }
      for (jint i = 0; i < IOSIntArray_Get(nil_chk(self->heightOfTrees_), layer); i++) {
        JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->nextAuthPaths_), layer - 1)), i), 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), i), 0, self->mdLength_);
        JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk([((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) getAuthPath]), i), 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->nextAuthPaths_), layer - 1)), i), 0, self->mdLength_);
      }
      for (jint i = 0; i < IOSIntArray_Get(nil_chk(self->K_), layer) - 1; i++) {
        (void) IOSObjectArray_Set(nil_chk(IOSObjectArray_Get(nil_chk(self->currentRetain_), layer)), i, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->nextRetain_), layer - 1)), i));
        (void) IOSObjectArray_Set(nil_chk(IOSObjectArray_Get(self->nextRetain_, layer - 1)), i, IOSObjectArray_Get(nil_chk([((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) getRetain]), i));
      }
      (void) IOSObjectArray_Set(nil_chk(self->currentStack_), layer, IOSObjectArray_Get(nil_chk(self->nextStack_), layer - 1));
      (void) IOSObjectArray_Set(self->nextStack_, layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) getStack]);
      (void) IOSObjectArray_Set(nil_chk(self->nextRoot_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) getRoot]);
      IOSByteArray *OTSseed = [IOSByteArray newArrayWithLength:self->mdLength_];
      IOSByteArray *dummy = [IOSByteArray newArrayWithLength:self->mdLength_];
      JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(self->currentSeeds_), layer - 1), 0, dummy, 0, self->mdLength_);
      OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      [((LibOrgBouncycastlePqcCryptoGmssGMSSRootSig *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextRootSig_), layer - 1))) initSignWithByteArray:OTSseed withByteArray:IOSObjectArray_Get(nil_chk(self->nextRoot_), layer - 1)];
      LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_nextKeyWithInt_(self, layer - 1);
    }
  }
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateKeyWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_computeAuthPathsWithInt_(self, layer);
  if (layer > 0) {
    if (layer > 1) {
      (void) IOSObjectArray_Set(nil_chk(self->nextNextLeaf_), layer - 1 - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->nextNextLeaf_, layer - 1 - 1))) nextLeaf]);
    }
    (void) IOSObjectArray_Set(nil_chk(self->upperLeaf_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->upperLeaf_, layer - 1))) nextLeaf]);
    jint t = JreFpToInt(JavaLangMath_floorWithDouble_((jdouble) ([self getNumLeafsWithInt:layer] * 2) / (jdouble) (IOSIntArray_Get(nil_chk(self->heightOfTrees_), layer - 1) - IOSIntArray_Get(nil_chk(self->K_), layer - 1))));
    if (IOSIntArray_Get(nil_chk(self->index_), layer) % t == 1) {
      if (IOSIntArray_Get(self->index_, layer) > 1 && IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1) >= 0) {
        IOSByteArray *leaf = [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->upperTreehashLeaf_), layer - 1))) getLeaf];
        @try {
          [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer - 1)), IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1)))) updateWithLibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom:self->gmssRandom_ withByteArray:leaf];
          if ([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer - 1)), IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1)))) wasFinished]) {
          }
        }
        @catch (JavaLangException *e) {
          [((JavaIoPrintStream *) nil_chk(JreLoadStatic(JavaLangSystem, out))) printlnWithId:e];
        }
      }
      *IOSIntArray_GetRef(nil_chk(self->minTreehash_), layer - 1) = LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(self, layer - 1);
      if (IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1) >= 0) {
        IOSByteArray *seed = [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer - 1)), IOSIntArray_Get(self->minTreehash_, layer - 1)))) getSeedActive];
        (void) IOSObjectArray_SetAndConsume(nil_chk(self->upperTreehashLeaf_), layer - 1, new_LibOrgBouncycastlePqcCryptoGmssGMSSLeaf_initWithLibOrgBouncycastleCryptoDigest_withInt_withInt_withByteArray_([((id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>) nil_chk(self->digestProvider_)) get], IOSIntArray_Get(nil_chk(self->otsIndex_), layer - 1), t, seed));
        (void) IOSObjectArray_Set(nil_chk(self->upperTreehashLeaf_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->upperTreehashLeaf_, layer - 1))) nextLeaf]);
      }
    }
    else {
      if (IOSIntArray_Get(nil_chk(self->minTreehash_), layer - 1) >= 0) {
        (void) IOSObjectArray_Set(nil_chk(self->upperTreehashLeaf_), layer - 1, [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(self->upperTreehashLeaf_, layer - 1))) nextLeaf]);
      }
    }
    [((LibOrgBouncycastlePqcCryptoGmssGMSSRootSig *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextRootSig_), layer - 1))) updateSign];
    if (IOSIntArray_Get(nil_chk(self->index_), layer) == 1) {
      [((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) initialize__WithJavaUtilVector:new_JavaUtilVector_init()];
    }
    LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateNextNextAuthRootWithInt_(self, layer);
  }
}

jint LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  jint minTreehash = -1;
  for (jint h = 0; h < IOSIntArray_Get(nil_chk(self->heightOfTrees_), layer) - IOSIntArray_Get(nil_chk(self->K_), layer); h++) {
    if ([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), h))) wasInitialized] && ![((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), h))) wasFinished]) {
      if (minTreehash == -1) {
        minTreehash = h;
      }
      else if ([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), h))) getLowestNodeHeight] < [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), minTreehash))) getLowestNodeHeight]) {
        minTreehash = h;
      }
    }
  }
  return minTreehash;
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_computeAuthPathsWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  jint Phi = IOSIntArray_Get(nil_chk(self->index_), layer);
  jint H = IOSIntArray_Get(nil_chk(self->heightOfTrees_), layer);
  jint K = IOSIntArray_Get(nil_chk(self->K_), layer);
  for (jint i = 0; i < H - K; i++) {
    [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i))) updateNextSeedWithLibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom:self->gmssRandom_];
  }
  jint Tau = LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_heightOfPhiWithInt_(self, Phi);
  IOSByteArray *OTSseed = [IOSByteArray newArrayWithLength:self->mdLength_];
  OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:IOSObjectArray_Get(nil_chk(self->currentSeeds_), layer)];
  jint L = (JreURShift32(Phi, (Tau + 1))) & 1;
  IOSByteArray *tempKeep = [IOSByteArray newArrayWithLength:self->mdLength_];
  if (Tau < H - 1 && L == 0) {
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), Tau), 0, tempKeep, 0, self->mdLength_);
  }
  IOSByteArray *help = [IOSByteArray newArrayWithLength:self->mdLength_];
  if (Tau == 0) {
    if (layer == self->numLayer_ - 1) {
      LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature *ots = new_LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature_initWithByteArray_withLibOrgBouncycastleCryptoDigest_withInt_(OTSseed, [((id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>) nil_chk(self->digestProvider_)) get], IOSIntArray_Get(nil_chk(self->otsIndex_), layer));
      help = [ots getPublicKey];
    }
    else {
      IOSByteArray *dummy = [IOSByteArray newArrayWithLength:self->mdLength_];
      JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(self->currentSeeds_), layer), 0, dummy, 0, self->mdLength_);
      (void) [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:dummy];
      help = [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->upperLeaf_), layer))) getLeaf];
      [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->upperLeaf_), layer))) initLeafCalcWithByteArray:dummy];
    }
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(help, 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), 0), 0, self->mdLength_);
  }
  else {
    IOSByteArray *toBeHashed = [IOSByteArray newArrayWithLength:JreLShift32(self->mdLength_, 1)];
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), Tau - 1), 0, toBeHashed, 0, self->mdLength_);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->keep_), layer)), JreFpToInt(JavaLangMath_floorWithDouble_((Tau - 1) / 2))), 0, toBeHashed, self->mdLength_, self->mdLength_);
    [((id<LibOrgBouncycastleCryptoDigest>) nil_chk(self->messDigestTrees_)) updateWithByteArray:toBeHashed withInt:0 withInt:toBeHashed->size_];
    (void) IOSObjectArray_SetAndConsume(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), Tau, [IOSByteArray newArrayWithLength:[((id<LibOrgBouncycastleCryptoDigest>) nil_chk(self->messDigestTrees_)) getDigestSize]]);
    [((id<LibOrgBouncycastleCryptoDigest>) nil_chk(self->messDigestTrees_)) doFinalWithByteArray:IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), Tau) withInt:0];
    for (jint i = 0; i < Tau; i++) {
      if (i < H - K) {
        if ([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i))) wasFinished]) {
          JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i))) getFirstNode], 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), i), 0, self->mdLength_);
          [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i))) destroy];
        }
        else {
          [((JavaIoPrintStream *) nil_chk(JreLoadStatic(JavaLangSystem, err))) printlnWithNSString:JreStrcat("$ICI$", @"Treehash (", layer, ',', i, @") not finished when needed in AuthPathComputation")];
        }
      }
      if (i < H - 1 && i >= H - K) {
        if ([((JavaUtilVector *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentRetain_), layer)), i - (H - K)))) size] > 0) {
          JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([((JavaUtilVector *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentRetain_), layer)), i - (H - K)))) lastElement], 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentAuthPaths_), layer)), i), 0, self->mdLength_);
          [((JavaUtilVector *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentRetain_), layer)), i - (H - K)))) removeElementAtWithInt:[((JavaUtilVector *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->currentRetain_, layer)), i - (H - K)))) size] - 1];
        }
      }
      if (i < H - K) {
        jint startPoint = Phi + 3 * (JreLShift32(1, i));
        if (startPoint < IOSIntArray_Get(nil_chk(self->numLeafs_), layer)) {
          [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), i))) initialize__];
        }
      }
    }
  }
  if (Tau < H - 1 && L == 0) {
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(tempKeep, 0, IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->keep_), layer)), JreFpToInt(JavaLangMath_floorWithDouble_(Tau / 2))), 0, self->mdLength_);
  }
  if (layer == self->numLayer_ - 1) {
    for (jint tmp = 1; tmp <= (H - K) / 2; tmp++) {
      jint minTreehash = LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(self, layer);
      if (minTreehash >= 0) {
        @try {
          IOSByteArray *seed = [IOSByteArray newArrayWithLength:self->mdLength_];
          JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), minTreehash))) getSeedActive], 0, seed, 0, self->mdLength_);
          IOSByteArray *seed2 = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:seed];
          LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature *ots = new_LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature_initWithByteArray_withLibOrgBouncycastleCryptoDigest_withInt_(seed2, [((id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>) nil_chk(self->digestProvider_)) get], IOSIntArray_Get(nil_chk(self->otsIndex_), layer));
          IOSByteArray *leaf = [ots getPublicKey];
          [((LibOrgBouncycastlePqcCryptoGmssTreehash *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->currentTreehash_), layer)), minTreehash))) updateWithLibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom:self->gmssRandom_ withByteArray:leaf];
        }
        @catch (JavaLangException *e) {
          [((JavaIoPrintStream *) nil_chk(JreLoadStatic(JavaLangSystem, out))) printlnWithId:e];
        }
      }
    }
  }
  else {
    *IOSIntArray_GetRef(nil_chk(self->minTreehash_), layer) = LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_getMinTreehashIndexWithInt_(self, layer);
  }
}

jint LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_heightOfPhiWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint Phi) {
  if (Phi == 0) {
    return -1;
  }
  jint Tau = 0;
  jint modul = 1;
  while (Phi % modul == 0) {
    modul *= 2;
    Tau += 1;
  }
  return Tau - 1;
}

void LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters_updateNextNextAuthRootWithInt_(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters *self, jint layer) {
  IOSByteArray *OTSseed = [IOSByteArray newArrayWithLength:self->mdLength_];
  OTSseed = [((LibOrgBouncycastlePqcCryptoGmssUtilGMSSRandom *) nil_chk(self->gmssRandom_)) nextSeedWithByteArray:IOSObjectArray_Get(nil_chk(self->nextNextSeeds_), layer - 1)];
  if (layer == self->numLayer_ - 1) {
    LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature *ots = new_LibOrgBouncycastlePqcCryptoGmssUtilWinternitzOTSignature_initWithByteArray_withLibOrgBouncycastleCryptoDigest_withInt_(OTSseed, [((id<LibOrgBouncycastlePqcCryptoGmssGMSSDigestProvider>) nil_chk(self->digestProvider_)) get], IOSIntArray_Get(nil_chk(self->otsIndex_), layer));
    [((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) updateWithByteArray:IOSObjectArray_Get(nil_chk(self->nextNextSeeds_), layer - 1) withByteArray:[ots getPublicKey]];
  }
  else {
    [((LibOrgBouncycastlePqcCryptoGmssGMSSRootCalc *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextRoot_), layer - 1))) updateWithByteArray:IOSObjectArray_Get(nil_chk(self->nextNextSeeds_), layer - 1) withByteArray:[((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextLeaf_), layer - 1))) getLeaf]];
    [((LibOrgBouncycastlePqcCryptoGmssGMSSLeaf *) nil_chk(IOSObjectArray_Get(nil_chk(self->nextNextLeaf_), layer - 1))) initLeafCalcWithByteArray:IOSObjectArray_Get(nil_chk(self->nextNextSeeds_), layer - 1)];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastlePqcCryptoGmssGMSSPrivateKeyParameters)
