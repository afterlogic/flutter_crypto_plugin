//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../android/src/main/kotlin/lib/org/bouncycastle/pqc/crypto/ntru/NTRUEngine.java
//

#include "Arrays.h"
#include "CipherParameters.h"
#include "CryptoServicesRegistrar.h"
#include "DataLengthException.h"
#include "DenseTernaryPolynomial.h"
#include "Digest.h"
#include "IOSPrimitiveArray.h"
#include "IndexGenerator.h"
#include "IntegerPolynomial.h"
#include "InvalidCipherTextException.h"
#include "J2ObjC_source.h"
#include "NTRUEncryptionParameters.h"
#include "NTRUEncryptionPrivateKeyParameters.h"
#include "NTRUEncryptionPublicKeyParameters.h"
#include "NTRUEngine.h"
#include "NTRUParameters.h"
#include "ParametersWithRandom.h"
#include "PqcMathPolynomial.h"
#include "ProductFormPolynomial.h"
#include "SparseTernaryPolynomial.h"
#include "TernaryPolynomial.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/System.h"
#include "java/security/SecureRandom.h"

@interface LibOrgBouncycastlePqcCryptoNtruNTRUEngine () {
 @public
  jboolean forEncryption_;
  LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *params_;
  LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *pubKey_;
  LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *privKey_;
  JavaSecuritySecureRandom *random_;
}

- (IOSByteArray *)encryptWithByteArray:(IOSByteArray *)m
withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters:(LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *)pubKey;

- (IOSByteArray *)buildSDataWithByteArray:(IOSByteArray *)oid
                            withByteArray:(IOSByteArray *)m
                                  withInt:(jint)l
                            withByteArray:(IOSByteArray *)b
                            withByteArray:(IOSByteArray *)hTrunc;

- (id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>)generateBlindingPolyWithByteArray:(IOSByteArray *)seed
                                                                                    withByteArray:(IOSByteArray *)M;

- (IOSIntArray *)generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator:(LibOrgBouncycastlePqcCryptoNtruIndexGenerator *)ig
                                                                                 withInt:(jint)dr;

- (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)MGFWithByteArray:(IOSByteArray *)seed
                                                                       withInt:(jint)N
                                                                       withInt:(jint)minCallsR
                                                                   withBoolean:(jboolean)hashSeed;

- (void)putIntWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg
                                         withInt:(jint)counter;

- (IOSByteArray *)calcHashWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg;

- (IOSByteArray *)calcHashWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg
                                               withByteArray:(IOSByteArray *)input;

- (IOSByteArray *)decryptWithByteArray:(IOSByteArray *)data
withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters:(LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *)privKey;

- (IOSByteArray *)copyOfWithByteArray:(IOSByteArray *)src
                              withInt:(jint)len OBJC_METHOD_FAMILY_NONE;

- (jint)log2WithInt:(jint)value;

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, params_, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, pubKey_, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, privKey_, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, random_, JavaSecuritySecureRandom *)

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_encryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *m, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *pubKey);

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_buildSDataWithByteArray_withByteArray_withInt_withByteArray_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *oid, IOSByteArray *m, jint l, IOSByteArray *b, IOSByteArray *hTrunc);

__attribute__((unused)) static id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial> LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingPolyWithByteArray_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *seed, IOSByteArray *M);

__attribute__((unused)) static IOSIntArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, LibOrgBouncycastlePqcCryptoNtruIndexGenerator *ig, jint dr);

__attribute__((unused)) static LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_MGFWithByteArray_withInt_withInt_withBoolean_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *seed, jint N, jint minCallsR, jboolean hashSeed);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoNtruNTRUEngine_putIntWithLibOrgBouncycastleCryptoDigest_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg, jint counter);

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg);

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg, IOSByteArray *input);

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_decryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *data, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *privKey);

__attribute__((unused)) static IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_copyOfWithByteArray_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *src, jint len);

__attribute__((unused)) static jint LibOrgBouncycastlePqcCryptoNtruNTRUEngine_log2WithInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, jint value);

@implementation LibOrgBouncycastlePqcCryptoNtruNTRUEngine

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  LibOrgBouncycastlePqcCryptoNtruNTRUEngine_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)init__WithBoolean:(jboolean)forEncryption
withLibOrgBouncycastleCryptoCipherParameters:(id<LibOrgBouncycastleCryptoCipherParameters>)parameters {
  self->forEncryption_ = forEncryption;
  if (forEncryption) {
    if ([parameters isKindOfClass:[LibOrgBouncycastleCryptoParamsParametersWithRandom class]]) {
      LibOrgBouncycastleCryptoParamsParametersWithRandom *p = (LibOrgBouncycastleCryptoParamsParametersWithRandom *) parameters;
      self->random_ = [((LibOrgBouncycastleCryptoParamsParametersWithRandom *) nil_chk(p)) getRandom];
      self->pubKey_ = (LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *) cast_chk([p getParameters], [LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters class]);
    }
    else {
      self->random_ = LibOrgBouncycastleCryptoCryptoServicesRegistrar_getSecureRandom();
      self->pubKey_ = (LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *) cast_chk(parameters, [LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters class]);
    }
    self->params_ = [((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *) nil_chk(pubKey_)) getParameters];
  }
  else {
    self->privKey_ = (LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *) cast_chk(parameters, [LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters class]);
    self->params_ = [((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *) nil_chk(privKey_)) getParameters];
  }
}

- (jint)getInputBlockSize {
  return ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->maxMsgLenBytes_;
}

- (jint)getOutputBlockSize {
  return ((((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->N_ * LibOrgBouncycastlePqcCryptoNtruNTRUEngine_log2WithInt_(self, params_->q_)) + 7) / 8;
}

- (IOSByteArray *)processBlockWithByteArray:(IOSByteArray *)inArg
                                    withInt:(jint)inOff
                                    withInt:(jint)len {
  IOSByteArray *tmp = [IOSByteArray newArrayWithLength:len];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(inArg, inOff, tmp, 0, len);
  if (forEncryption_) {
    return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_encryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters_(self, tmp, pubKey_);
  }
  else {
    return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_decryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters_(self, tmp, privKey_);
  }
}

- (IOSByteArray *)encryptWithByteArray:(IOSByteArray *)m
withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters:(LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *)pubKey {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_encryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters_(self, m, pubKey);
}

- (IOSByteArray *)buildSDataWithByteArray:(IOSByteArray *)oid
                            withByteArray:(IOSByteArray *)m
                                  withInt:(jint)l
                            withByteArray:(IOSByteArray *)b
                            withByteArray:(IOSByteArray *)hTrunc {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_buildSDataWithByteArray_withByteArray_withInt_withByteArray_withByteArray_(self, oid, m, l, b, hTrunc);
}

- (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)encryptWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:(LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)m
                                                                     withLibOrgBouncycastlePqcMathNtruPolynomialTernaryPolynomial:(id<LibOrgBouncycastlePqcMathNtruPolynomialTernaryPolynomial>)r
                                                                     withLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:(LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)pubKey {
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *e = [((id<LibOrgBouncycastlePqcMathNtruPolynomialTernaryPolynomial>) nil_chk(r)) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:pubKey withInt:((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->q_];
  [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(e)) addWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:m withInt:((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->q_];
  [e ensurePositiveWithInt:((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->q_];
  return e;
}

- (id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>)generateBlindingPolyWithByteArray:(IOSByteArray *)seed
                                                                                    withByteArray:(IOSByteArray *)M {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingPolyWithByteArray_withByteArray_(self, seed, M);
}

- (IOSIntArray *)generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator:(LibOrgBouncycastlePqcCryptoNtruIndexGenerator *)ig
                                                                                 withInt:(jint)dr {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(self, ig, dr);
}

- (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)MGFWithByteArray:(IOSByteArray *)seed
                                                                       withInt:(jint)N
                                                                       withInt:(jint)minCallsR
                                                                   withBoolean:(jboolean)hashSeed {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_MGFWithByteArray_withInt_withInt_withBoolean_(self, seed, N, minCallsR, hashSeed);
}

- (void)putIntWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg
                                         withInt:(jint)counter {
  LibOrgBouncycastlePqcCryptoNtruNTRUEngine_putIntWithLibOrgBouncycastleCryptoDigest_withInt_(self, hashAlg, counter);
}

- (IOSByteArray *)calcHashWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_(self, hashAlg);
}

- (IOSByteArray *)calcHashWithLibOrgBouncycastleCryptoDigest:(id<LibOrgBouncycastleCryptoDigest>)hashAlg
                                               withByteArray:(IOSByteArray *)input {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_withByteArray_(self, hashAlg, input);
}

- (IOSByteArray *)decryptWithByteArray:(IOSByteArray *)data
withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters:(LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *)privKey {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_decryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters_(self, data, privKey);
}

- (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)decryptWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:(LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)e
                                                                     withLibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial:(id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>)priv_t
                                                                     withLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:(LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *)priv_fp {
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *a;
  if (((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->fastFp_) {
    a = [((id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>) nil_chk(priv_t)) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:e withInt:params_->q_];
    [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(a)) multWithInt:3];
    [a addWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:e];
  }
  else {
    a = [((id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>) nil_chk(priv_t)) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:e withInt:params_->q_];
  }
  [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(a)) center0WithInt:((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->q_];
  [a mod3];
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *c = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(params_))->fastFp_ ? a : [new_LibOrgBouncycastlePqcMathNtruPolynomialDenseTernaryPolynomial_initWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial_(a) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:priv_fp withInt:3];
  [c center0WithInt:3];
  return c;
}

- (IOSByteArray *)copyOfWithByteArray:(IOSByteArray *)src
                              withInt:(jint)len {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_copyOfWithByteArray_withInt_(self, src, len);
}

- (jint)log2WithInt:(jint)value {
  return LibOrgBouncycastlePqcCryptoNtruNTRUEngine_log2WithInt_(self, value);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 0, 1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, 2, 3, 4, -1, -1, -1 },
    { NULL, "[B", 0x2, 5, 6, -1, -1, -1, -1 },
    { NULL, "[B", 0x2, 7, 8, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;", 0x4, 5, 9, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial;", 0x2, 10, 11, -1, -1, -1, -1 },
    { NULL, "[I", 0x2, 12, 13, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;", 0x2, 14, 15, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 16, 17, -1, -1, -1, -1 },
    { NULL, "[B", 0x2, 18, 19, -1, -1, -1, -1 },
    { NULL, "[B", 0x2, 18, 20, -1, -1, -1, -1 },
    { NULL, "[B", 0x2, 21, 22, 4, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;", 0x4, 21, 23, -1, -1, -1, -1 },
    { NULL, "[B", 0x2, 24, 25, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 26, 27, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(init__WithBoolean:withLibOrgBouncycastleCryptoCipherParameters:);
  methods[2].selector = @selector(getInputBlockSize);
  methods[3].selector = @selector(getOutputBlockSize);
  methods[4].selector = @selector(processBlockWithByteArray:withInt:withInt:);
  methods[5].selector = @selector(encryptWithByteArray:withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters:);
  methods[6].selector = @selector(buildSDataWithByteArray:withByteArray:withInt:withByteArray:withByteArray:);
  methods[7].selector = @selector(encryptWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:withLibOrgBouncycastlePqcMathNtruPolynomialTernaryPolynomial:withLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:);
  methods[8].selector = @selector(generateBlindingPolyWithByteArray:withByteArray:);
  methods[9].selector = @selector(generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator:withInt:);
  methods[10].selector = @selector(MGFWithByteArray:withInt:withInt:withBoolean:);
  methods[11].selector = @selector(putIntWithLibOrgBouncycastleCryptoDigest:withInt:);
  methods[12].selector = @selector(calcHashWithLibOrgBouncycastleCryptoDigest:);
  methods[13].selector = @selector(calcHashWithLibOrgBouncycastleCryptoDigest:withByteArray:);
  methods[14].selector = @selector(decryptWithByteArray:withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters:);
  methods[15].selector = @selector(decryptWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:withLibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial:withLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:);
  methods[16].selector = @selector(copyOfWithByteArray:withInt:);
  methods[17].selector = @selector(log2WithInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "forEncryption_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "params_", "LLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "pubKey_", "LLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "privKey_", "LLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "random_", "LJavaSecuritySecureRandom;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "init", "ZLLibOrgBouncycastleCryptoCipherParameters;", "processBlock", "[BII", "LLibOrgBouncycastleCryptoInvalidCipherTextException;", "encrypt", "[BLLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters;", "buildSData", "[B[BI[B[B", "LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;LLibOrgBouncycastlePqcMathNtruPolynomialTernaryPolynomial;LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;", "generateBlindingPoly", "[B[B", "generateBlindingCoeffs", "LLibOrgBouncycastlePqcCryptoNtruIndexGenerator;I", "MGF", "[BIIZ", "putInt", "LLibOrgBouncycastleCryptoDigest;I", "calcHash", "LLibOrgBouncycastleCryptoDigest;", "LLibOrgBouncycastleCryptoDigest;[B", "decrypt", "[BLLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters;", "LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;LLibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial;LLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial;", "copyOf", "[BI", "log2", "I" };
  static const J2ObjcClassInfo _LibOrgBouncycastlePqcCryptoNtruNTRUEngine = { "NTRUEngine", "lib.org.bouncycastle.pqc.crypto.ntru", ptrTable, methods, fields, 7, 0x1, 18, 5, -1, -1, -1, -1, -1 };
  return &_LibOrgBouncycastlePqcCryptoNtruNTRUEngine;
}

@end

void LibOrgBouncycastlePqcCryptoNtruNTRUEngine_init(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self) {
  NSObject_init(self);
}

LibOrgBouncycastlePqcCryptoNtruNTRUEngine *new_LibOrgBouncycastlePqcCryptoNtruNTRUEngine_init() {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, init)
}

LibOrgBouncycastlePqcCryptoNtruNTRUEngine *create_LibOrgBouncycastlePqcCryptoNtruNTRUEngine_init() {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoNtruNTRUEngine, init)
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_encryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *m, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *pubKey) {
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *pub = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPublicKeyParameters *) nil_chk(pubKey))->h_;
  jint N = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->N_;
  jint q = self->params_->q_;
  jint maxLenBytes = self->params_->maxMsgLenBytes_;
  jint db = self->params_->db_;
  jint bufferLenBits = self->params_->bufferLenBits_;
  jint dm0 = self->params_->dm0_;
  jint pkLen = self->params_->pkLen_;
  jint minCallsMask = self->params_->minCallsMask_;
  jboolean hashSeed = self->params_->hashSeed_;
  IOSByteArray *oid = self->params_->oid_;
  jint l = ((IOSByteArray *) nil_chk(m))->size_;
  if (maxLenBytes > 255) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"llen values bigger than 1 are not supported");
  }
  if (l > maxLenBytes) {
    @throw new_LibOrgBouncycastleCryptoDataLengthException_initWithNSString_(JreStrcat("$ICI", @"Message too long: ", l, '>', maxLenBytes));
  }
  while (true) {
    IOSByteArray *b = [IOSByteArray newArrayWithLength:db / 8];
    [((JavaSecuritySecureRandom *) nil_chk(self->random_)) nextBytesWithByteArray:b];
    IOSByteArray *p0 = [IOSByteArray newArrayWithLength:maxLenBytes + 1 - l];
    IOSByteArray *M = [IOSByteArray newArrayWithLength:bufferLenBits / 8];
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(b, 0, M, 0, b->size_);
    *IOSByteArray_GetRef(M, b->size_) = (jbyte) l;
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(m, 0, M, b->size_ + 1, m->size_);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(p0, 0, M, b->size_ + 1 + m->size_, p0->size_);
    LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *mTrin = LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial_fromBinary3SvesWithByteArray_withInt_(M, N);
    IOSByteArray *bh = [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(pub)) toBinaryWithInt:q];
    IOSByteArray *hTrunc = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_copyOfWithByteArray_withInt_(self, bh, pkLen / 8);
    IOSByteArray *sData = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_buildSDataWithByteArray_withByteArray_withInt_withByteArray_withByteArray_(self, oid, m, l, b, hTrunc);
    id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial> r = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingPolyWithByteArray_withByteArray_(self, sData, M);
    LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *R = [((id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>) nil_chk(r)) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:pub withInt:q];
    LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *R4 = (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) cast_chk([((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(R)) java_clone], [LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial class]);
    [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(R4)) modPositiveWithInt:4];
    IOSByteArray *oR4 = [R4 toBinaryWithInt:4];
    LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *mask = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_MGFWithByteArray_withInt_withInt_withBoolean_(self, oR4, N, minCallsMask, hashSeed);
    [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(mTrin)) addWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:mask];
    [mTrin mod3];
    if ([mTrin countWithInt:-1] < dm0) {
      continue;
    }
    if ([mTrin countWithInt:0] < dm0) {
      continue;
    }
    if ([mTrin countWithInt:1] < dm0) {
      continue;
    }
    [R addWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:mTrin withInt:q];
    [R ensurePositiveWithInt:q];
    return [R toBinaryWithInt:q];
  }
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_buildSDataWithByteArray_withByteArray_withInt_withByteArray_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *oid, IOSByteArray *m, jint l, IOSByteArray *b, IOSByteArray *hTrunc) {
  IOSByteArray *sData = [IOSByteArray newArrayWithLength:((IOSByteArray *) nil_chk(oid))->size_ + l + ((IOSByteArray *) nil_chk(b))->size_ + ((IOSByteArray *) nil_chk(hTrunc))->size_];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(oid, 0, sData, 0, oid->size_);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(m, 0, sData, oid->size_, ((IOSByteArray *) nil_chk(m))->size_);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(b, 0, sData, oid->size_ + m->size_, b->size_);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(hTrunc, 0, sData, oid->size_ + m->size_ + b->size_, hTrunc->size_);
  return sData;
}

id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial> LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingPolyWithByteArray_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *seed, IOSByteArray *M) {
  LibOrgBouncycastlePqcCryptoNtruIndexGenerator *ig = new_LibOrgBouncycastlePqcCryptoNtruIndexGenerator_initWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters_(seed, self->params_);
  if (((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->polyType_ == LibOrgBouncycastlePqcCryptoNtruNTRUParameters_TERNARY_POLYNOMIAL_TYPE_PRODUCT) {
    LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial *r1 = new_LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_initWithIntArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(self, ig, self->params_->dr1_));
    LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial *r2 = new_LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_initWithIntArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(self, ig, ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->dr2_));
    LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial *r3 = new_LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_initWithIntArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(self, ig, ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->dr3_));
    return new_LibOrgBouncycastlePqcMathNtruPolynomialProductFormPolynomial_initWithLibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_withLibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_withLibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_(r1, r2, r3);
  }
  else {
    jint dr = self->params_->dr_;
    jboolean sparse = self->params_->sparse_;
    IOSIntArray *r = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(self, ig, dr);
    if (sparse) {
      return new_LibOrgBouncycastlePqcMathNtruPolynomialSparseTernaryPolynomial_initWithIntArray_(r);
    }
    else {
      return new_LibOrgBouncycastlePqcMathNtruPolynomialDenseTernaryPolynomial_initWithIntArray_(r);
    }
  }
}

IOSIntArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingCoeffsWithLibOrgBouncycastlePqcCryptoNtruIndexGenerator_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, LibOrgBouncycastlePqcCryptoNtruIndexGenerator *ig, jint dr) {
  jint N = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->N_;
  IOSIntArray *r = [IOSIntArray newArrayWithLength:N];
  for (jint coeff = -1; coeff <= 1; coeff += 2) {
    jint t = 0;
    while (t < dr) {
      jint i = [((LibOrgBouncycastlePqcCryptoNtruIndexGenerator *) nil_chk(ig)) nextIndex];
      if (IOSIntArray_Get(r, i) == 0) {
        *IOSIntArray_GetRef(r, i) = coeff;
        t++;
      }
    }
  }
  return r;
}

LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_MGFWithByteArray_withInt_withInt_withBoolean_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *seed, jint N, jint minCallsR, jboolean hashSeed) {
  id<LibOrgBouncycastleCryptoDigest> hashAlg = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->hashAlg_;
  jint hashLen = [((id<LibOrgBouncycastleCryptoDigest>) nil_chk(hashAlg)) getDigestSize];
  IOSByteArray *buf = [IOSByteArray newArrayWithLength:minCallsR * hashLen];
  IOSByteArray *Z = hashSeed ? LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_withByteArray_(self, hashAlg, seed) : seed;
  jint counter = 0;
  while (counter < minCallsR) {
    [hashAlg updateWithByteArray:Z withInt:0 withInt:Z->size_];
    LibOrgBouncycastlePqcCryptoNtruNTRUEngine_putIntWithLibOrgBouncycastleCryptoDigest_withInt_(self, hashAlg, counter);
    IOSByteArray *hash_ = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_(self, hashAlg);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(hash_, 0, buf, counter * hashLen, hashLen);
    counter++;
  }
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *i = new_LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial_initWithInt_(N);
  while (true) {
    jint cur = 0;
    for (jint index = 0; index != ((IOSByteArray *) nil_chk(buf))->size_; index++) {
      jint O = (jint) IOSByteArray_Get(buf, index) & (jint) 0xFF;
      if (O >= 243) {
        continue;
      }
      for (jint terIdx = 0; terIdx < 4; terIdx++) {
        jint rem3 = O % 3;
        *IOSIntArray_GetRef(nil_chk(i->coeffs_), cur) = rem3 - 1;
        cur++;
        if (cur == N) {
          return i;
        }
        O = (O - rem3) / 3;
      }
      *IOSIntArray_GetRef(nil_chk(i->coeffs_), cur) = O - 1;
      cur++;
      if (cur == N) {
        return i;
      }
    }
    if (cur >= N) {
      return i;
    }
    [hashAlg updateWithByteArray:Z withInt:0 withInt:Z->size_];
    LibOrgBouncycastlePqcCryptoNtruNTRUEngine_putIntWithLibOrgBouncycastleCryptoDigest_withInt_(self, hashAlg, counter);
    IOSByteArray *hash_ = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_(self, hashAlg);
    buf = hash_;
    counter++;
  }
}

void LibOrgBouncycastlePqcCryptoNtruNTRUEngine_putIntWithLibOrgBouncycastleCryptoDigest_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg, jint counter) {
  [((id<LibOrgBouncycastleCryptoDigest>) nil_chk(hashAlg)) updateWithByte:(jbyte) (JreRShift32(counter, 24))];
  [hashAlg updateWithByte:(jbyte) (JreRShift32(counter, 16))];
  [hashAlg updateWithByte:(jbyte) (JreRShift32(counter, 8))];
  [hashAlg updateWithByte:(jbyte) counter];
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg) {
  IOSByteArray *tmp = [IOSByteArray newArrayWithLength:[((id<LibOrgBouncycastleCryptoDigest>) nil_chk(hashAlg)) getDigestSize]];
  [hashAlg doFinalWithByteArray:tmp withInt:0];
  return tmp;
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_calcHashWithLibOrgBouncycastleCryptoDigest_withByteArray_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, id<LibOrgBouncycastleCryptoDigest> hashAlg, IOSByteArray *input) {
  IOSByteArray *tmp = [IOSByteArray newArrayWithLength:[((id<LibOrgBouncycastleCryptoDigest>) nil_chk(hashAlg)) getDigestSize]];
  [hashAlg updateWithByteArray:input withInt:0 withInt:((IOSByteArray *) nil_chk(input))->size_];
  [hashAlg doFinalWithByteArray:tmp withInt:0];
  return tmp;
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_decryptWithByteArray_withLibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *data, LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *privKey) {
  id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial> priv_t = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionPrivateKeyParameters *) nil_chk(privKey))->t_;
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *priv_fp = privKey->fp_;
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *pub = privKey->h_;
  jint N = ((LibOrgBouncycastlePqcCryptoNtruNTRUEncryptionParameters *) nil_chk(self->params_))->N_;
  jint q = self->params_->q_;
  jint db = self->params_->db_;
  jint maxMsgLenBytes = self->params_->maxMsgLenBytes_;
  jint dm0 = self->params_->dm0_;
  jint pkLen = self->params_->pkLen_;
  jint minCallsMask = self->params_->minCallsMask_;
  jboolean hashSeed = self->params_->hashSeed_;
  IOSByteArray *oid = self->params_->oid_;
  if (maxMsgLenBytes > 255) {
    @throw new_LibOrgBouncycastleCryptoDataLengthException_initWithNSString_(@"maxMsgLenBytes values bigger than 255 are not supported");
  }
  jint bLen = db / 8;
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *e = LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial_fromBinaryWithByteArray_withInt_withInt_(data, N, q);
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *ci = [self decryptWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:e withLibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial:priv_t withLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:priv_fp];
  if ([((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(ci)) countWithInt:-1] < dm0) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(@"Less than dm0 coefficients equal -1");
  }
  if ([ci countWithInt:0] < dm0) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(@"Less than dm0 coefficients equal 0");
  }
  if ([ci countWithInt:1] < dm0) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(@"Less than dm0 coefficients equal 1");
  }
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *cR = (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) cast_chk([((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(e)) java_clone], [LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial class]);
  [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(cR)) subWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:ci];
  [cR modPositiveWithInt:q];
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *cR4 = (LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) cast_chk([cR java_clone], [LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial class]);
  [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(cR4)) modPositiveWithInt:4];
  IOSByteArray *coR4 = [cR4 toBinaryWithInt:4];
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *mask = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_MGFWithByteArray_withInt_withInt_withBoolean_(self, coR4, N, minCallsMask, hashSeed);
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *cMTrin = ci;
  [cMTrin subWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:mask];
  [cMTrin mod3];
  IOSByteArray *cM = [cMTrin toBinary3Sves];
  IOSByteArray *cb = [IOSByteArray newArrayWithLength:bLen];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(cM, 0, cb, 0, bLen);
  jint cl = IOSByteArray_Get(nil_chk(cM), bLen) & (jint) 0xFF;
  if (cl > maxMsgLenBytes) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(JreStrcat("$ICI", @"Message too long: ", cl, '>', maxMsgLenBytes));
  }
  IOSByteArray *cm = [IOSByteArray newArrayWithLength:cl];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(cM, bLen + 1, cm, 0, cl);
  IOSByteArray *p0 = [IOSByteArray newArrayWithLength:cM->size_ - (bLen + 1 + cl)];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(cM, bLen + 1 + cl, p0, 0, p0->size_);
  if (!LibOrgBouncycastleUtilArrays_constantTimeAreEqualWithByteArray_withByteArray_(p0, [IOSByteArray newArrayWithLength:p0->size_])) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(@"The message is not followed by zeroes");
  }
  IOSByteArray *bh = [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(pub)) toBinaryWithInt:q];
  IOSByteArray *hTrunc = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_copyOfWithByteArray_withInt_(self, bh, pkLen / 8);
  IOSByteArray *sData = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_buildSDataWithByteArray_withByteArray_withInt_withByteArray_withByteArray_(self, oid, cm, cl, cb, hTrunc);
  id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial> cr = LibOrgBouncycastlePqcCryptoNtruNTRUEngine_generateBlindingPolyWithByteArray_withByteArray_(self, sData, cm);
  LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *cRPrime = [((id<LibOrgBouncycastlePqcMathNtruPolynomialPqcMathPolynomial>) nil_chk(cr)) multWithLibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial:pub];
  [((LibOrgBouncycastlePqcMathNtruPolynomialIntegerPolynomial *) nil_chk(cRPrime)) modPositiveWithInt:q];
  if (![cRPrime isEqual:cR]) {
    @throw new_LibOrgBouncycastleCryptoInvalidCipherTextException_initWithNSString_(@"Invalid message encoding");
  }
  return cm;
}

IOSByteArray *LibOrgBouncycastlePqcCryptoNtruNTRUEngine_copyOfWithByteArray_withInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, IOSByteArray *src, jint len) {
  IOSByteArray *tmp = [IOSByteArray newArrayWithLength:len];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(src, 0, tmp, 0, len < ((IOSByteArray *) nil_chk(src))->size_ ? len : src->size_);
  return tmp;
}

jint LibOrgBouncycastlePqcCryptoNtruNTRUEngine_log2WithInt_(LibOrgBouncycastlePqcCryptoNtruNTRUEngine *self, jint value) {
  if (value == 2048) {
    return 11;
  }
  @throw new_JavaLangIllegalStateException_initWithNSString_(@"log2 not fully implemented");
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastlePqcCryptoNtruNTRUEngine)
