//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../android/src/main/kotlin/lib/org/bouncycastle/pqc/crypto/xmss/XMSSReducedSignature.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "WOTSPlus.h"
#include "WOTSPlusParameters.h"
#include "WOTSPlusSignature.h"
#include "XMSSNode.h"
#include "XMSSParameters.h"
#include "XMSSReducedSignature.h"
#include "XMSSUtil.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/NullPointerException.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"

@interface LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature () {
 @public
  LibOrgBouncycastlePqcCryptoXmssXMSSParameters *params_;
  LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *wotsPlusSignature_;
  id<JavaUtilList> authPath_;
}

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature, params_, LibOrgBouncycastlePqcCryptoXmssXMSSParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature, wotsPlusSignature_, LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature, authPath_, id<JavaUtilList>)

@interface LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder () {
 @public
  LibOrgBouncycastlePqcCryptoXmssXMSSParameters *params_;
  LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *wotsPlusSignature_;
  id<JavaUtilList> authPath_;
  IOSByteArray *reducedSignature_;
}

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, params_, LibOrgBouncycastlePqcCryptoXmssXMSSParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, wotsPlusSignature_, LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, authPath_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, reducedSignature_, IOSByteArray *)

@implementation LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature

- (instancetype)initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder:(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *)builder {
  LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_(self, builder);
  return self;
}

- (IOSByteArray *)toByteArray {
  jint n = [((LibOrgBouncycastlePqcCryptoXmssXMSSParameters *) nil_chk(params_)) getDigestSize];
  jint signatureSize = [((LibOrgBouncycastlePqcCryptoXmssWOTSPlusParameters *) nil_chk([((LibOrgBouncycastlePqcCryptoXmssWOTSPlus *) nil_chk([params_ getWOTSPlus])) getParams])) getLen] * n;
  jint authPathSize = [params_ getHeight] * n;
  jint totalSize = signatureSize + authPathSize;
  IOSByteArray *out = [IOSByteArray newArrayWithLength:totalSize];
  jint position = 0;
  IOSObjectArray *signature = [((LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *) nil_chk(self->wotsPlusSignature_)) toByteArray];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(signature))->size_; i++) {
    LibOrgBouncycastlePqcCryptoXmssXMSSUtil_copyBytesAtOffsetWithByteArray_withByteArray_withInt_(out, IOSObjectArray_Get(signature, i), position);
    position += n;
  }
  for (jint i = 0; i < [((id<JavaUtilList>) nil_chk(authPath_)) size]; i++) {
    IOSByteArray *value = [((LibOrgBouncycastlePqcCryptoXmssXMSSNode *) nil_chk([authPath_ getWithInt:i])) getValue];
    LibOrgBouncycastlePqcCryptoXmssXMSSUtil_copyBytesAtOffsetWithByteArray_withByteArray_withInt_(out, value, position);
    position += n;
  }
  return out;
}

- (LibOrgBouncycastlePqcCryptoXmssXMSSParameters *)getParams {
  return params_;
}

- (LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *)getWOTSPlusSignature {
  return wotsPlusSignature_;
}

- (id<JavaUtilList>)getAuthPath {
  return authPath_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, 0, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssXMSSParameters;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaUtilList;", 0x1, -1, -1, -1, 1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder:);
  methods[1].selector = @selector(toByteArray);
  methods[2].selector = @selector(getParams);
  methods[3].selector = @selector(getWOTSPlusSignature);
  methods[4].selector = @selector(getAuthPath);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "params_", "LLibOrgBouncycastlePqcCryptoXmssXMSSParameters;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "wotsPlusSignature_", "LLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "authPath_", "LJavaUtilList;", .constantValue.asLong = 0, 0x12, -1, -1, 2, -1 },
  };
  static const void *ptrTable[] = { "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder;", "()Ljava/util/List<Llib/org/bouncycastle/pqc/crypto/xmss/XMSSNode;>;", "Ljava/util/List<Llib/org/bouncycastle/pqc/crypto/xmss/XMSSNode;>;" };
  static const J2ObjcClassInfo _LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature = { "XMSSReducedSignature", "lib.org.bouncycastle.pqc.crypto.xmss", ptrTable, methods, fields, 7, 0x1, 5, 3, -1, 0, -1, -1, -1 };
  return &_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature;
}

@end

void LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature *self, LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  NSObject_init(self);
  self->params_ = ((LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *) nil_chk(builder))->params_;
  if (self->params_ == nil) {
    @throw new_JavaLangNullPointerException_initWithNSString_(@"params == null");
  }
  jint n = [self->params_ getDigestSize];
  jint len = [((LibOrgBouncycastlePqcCryptoXmssWOTSPlusParameters *) nil_chk([((LibOrgBouncycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams])) getLen];
  jint height = [self->params_ getHeight];
  IOSByteArray *reducedSignature = builder->reducedSignature_;
  if (reducedSignature != nil) {
    jint signatureSize = len * n;
    jint authPathSize = height * n;
    jint totalSize = signatureSize + authPathSize;
    if (reducedSignature->size_ != totalSize) {
      @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"signature has wrong size");
    }
    jint position = 0;
    IOSObjectArray *wotsPlusSignature = [IOSObjectArray newArrayWithLength:len type:IOSClass_byteArray(1)];
    for (jint i = 0; i < wotsPlusSignature->size_; i++) {
      (void) IOSObjectArray_Set(wotsPlusSignature, i, LibOrgBouncycastlePqcCryptoXmssXMSSUtil_extractBytesAtOffsetWithByteArray_withInt_withInt_(reducedSignature, position, n));
      position += n;
    }
    self->wotsPlusSignature_ = new_LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature_initWithLibOrgBouncycastlePqcCryptoXmssWOTSPlusParameters_withByteArray2_([((LibOrgBouncycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams], wotsPlusSignature);
    id<JavaUtilList> nodeList = new_JavaUtilArrayList_init();
    for (jint i = 0; i < height; i++) {
      [nodeList addWithId:new_LibOrgBouncycastlePqcCryptoXmssXMSSNode_initWithInt_withByteArray_(i, LibOrgBouncycastlePqcCryptoXmssXMSSUtil_extractBytesAtOffsetWithByteArray_withInt_withInt_(reducedSignature, position, n))];
      position += n;
    }
    self->authPath_ = nodeList;
  }
  else {
    LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *tmpSignature = builder->wotsPlusSignature_;
    if (tmpSignature != nil) {
      self->wotsPlusSignature_ = tmpSignature;
    }
    else {
      self->wotsPlusSignature_ = new_LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature_initWithLibOrgBouncycastlePqcCryptoXmssWOTSPlusParameters_withByteArray2_([((LibOrgBouncycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams], [IOSByteArray newArrayWithDimensions:2 lengths:(jint[]){ len, n }]);
    }
    id<JavaUtilList> tmpAuthPath = builder->authPath_;
    if (tmpAuthPath != nil) {
      if ([tmpAuthPath size] != height) {
        @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"size of authPath needs to be equal to height of tree");
      }
      self->authPath_ = tmpAuthPath;
    }
    else {
      self->authPath_ = new_JavaUtilArrayList_init();
    }
  }
}

LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature *new_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature, initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_, builder)
}

LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature *create_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature, initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_, builder)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature)

@implementation LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder

- (instancetype)initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters:(LibOrgBouncycastlePqcCryptoXmssXMSSParameters *)params {
  LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_(self, params);
  return self;
}

- (LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withWOTSPlusSignatureWithLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature:(LibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature *)val {
  wotsPlusSignature_ = val;
  return self;
}

- (LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withAuthPathWithJavaUtilList:(id<JavaUtilList>)val {
  authPath_ = val;
  return self;
}

- (LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withReducedSignatureWithByteArray:(IOSByteArray *)val {
  reducedSignature_ = LibOrgBouncycastlePqcCryptoXmssXMSSUtil_cloneArrayWithByteArray_(val);
  return self;
}

- (LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature *)build {
  return new_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_initWithLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_(self);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 1, 2, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 3, 4, -1, 5, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 6, 7, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature;", 0x1, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters:);
  methods[1].selector = @selector(withWOTSPlusSignatureWithLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature:);
  methods[2].selector = @selector(withAuthPathWithJavaUtilList:);
  methods[3].selector = @selector(withReducedSignatureWithByteArray:);
  methods[4].selector = @selector(build);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "params_", "LLibOrgBouncycastlePqcCryptoXmssXMSSParameters;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "wotsPlusSignature_", "LLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "authPath_", "LJavaUtilList;", .constantValue.asLong = 0, 0x2, -1, -1, 8, -1 },
    { "reducedSignature_", "[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LLibOrgBouncycastlePqcCryptoXmssXMSSParameters;", "withWOTSPlusSignature", "LLibOrgBouncycastlePqcCryptoXmssWOTSPlusSignature;", "withAuthPath", "LJavaUtilList;", "(Ljava/util/List<Llib/org/bouncycastle/pqc/crypto/xmss/XMSSNode;>;)Llib/org/bouncycastle/pqc/crypto/xmss/XMSSReducedSignature$Builder;", "withReducedSignature", "[B", "Ljava/util/List<Llib/org/bouncycastle/pqc/crypto/xmss/XMSSNode;>;", "LLibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature;" };
  static const J2ObjcClassInfo _LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder = { "Builder", "lib.org.bouncycastle.pqc.crypto.xmss", ptrTable, methods, fields, 7, 0x9, 5, 4, 9, -1, -1, -1, -1 };
  return &_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder;
}

@end

void LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *self, LibOrgBouncycastlePqcCryptoXmssXMSSParameters *params) {
  NSObject_init(self);
  self->wotsPlusSignature_ = nil;
  self->authPath_ = nil;
  self->reducedSignature_ = nil;
  self->params_ = params;
}

LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *new_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_(LibOrgBouncycastlePqcCryptoXmssXMSSParameters *params) {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_, params)
}

LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder *create_LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_(LibOrgBouncycastlePqcCryptoXmssXMSSParameters *params) {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder, initWithLibOrgBouncycastlePqcCryptoXmssXMSSParameters_, params)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastlePqcCryptoXmssXMSSReducedSignature_Builder)
