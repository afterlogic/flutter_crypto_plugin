//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ../android/src/main/kotlin/lib/org/bouncycastle/pqc/crypto/rainbow/RainbowKeyPairGenerator.java
//

#include "AsymmetricCipherKeyPair.h"
#include "ComputeInField.h"
#include "CryptoServicesRegistrar.h"
#include "GF2Field.h"
#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "KeyGenerationParameters.h"
#include "Layer.h"
#include "RainbowKeyGenerationParameters.h"
#include "RainbowKeyPairGenerator.h"
#include "RainbowParameters.h"
#include "RainbowPrivateKeyParameters.h"
#include "RainbowPublicKeyParameters.h"
#include "java/security/SecureRandom.h"

@interface LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator () {
 @public
  jboolean initialized_;
  JavaSecuritySecureRandom *sr_;
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *rainbowParams_;
  IOSObjectArray *A1_;
  IOSObjectArray *A1inv_;
  IOSShortArray *b1_;
  IOSObjectArray *A2_;
  IOSObjectArray *A2inv_;
  IOSShortArray *b2_;
  jint numOfLayers_;
  IOSObjectArray *layers_;
  IOSIntArray *vi_;
  IOSObjectArray *pub_quadratic_;
  IOSObjectArray *pub_singular_;
  IOSShortArray *pub_scalar_;
}

- (void)initializeDefault OBJC_METHOD_FAMILY_NONE;

- (void)keygen;

- (void)generateL1;

- (void)generateL2;

- (void)generateF;

- (void)computePublicKey;

- (void)compactPublicKeyWithShortArray3:(IOSObjectArray *)coeff_quadratic_to_compact;

@end

J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, sr_, JavaSecuritySecureRandom *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, rainbowParams_, LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, A1_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, A1inv_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, b1_, IOSShortArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, A2_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, A2inv_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, b2_, IOSShortArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, layers_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, vi_, IOSIntArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, pub_quadratic_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, pub_singular_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, pub_scalar_, IOSShortArray *)

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_initializeDefault(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_keygen(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL1(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL2(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateF(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_computePublicKey(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self);

__attribute__((unused)) static void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_compactPublicKeyWithShortArray3_(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self, IOSObjectArray *coeff_quadratic_to_compact);

@implementation LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (LibOrgBouncycastleCryptoAsymmetricCipherKeyPair *)genKeyPair {
  LibOrgBouncycastlePqcCryptoRainbowRainbowPrivateKeyParameters *privKey;
  LibOrgBouncycastlePqcCryptoRainbowRainbowPublicKeyParameters *pubKey;
  if (!initialized_) {
    LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_initializeDefault(self);
  }
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_keygen(self);
  privKey = new_LibOrgBouncycastlePqcCryptoRainbowRainbowPrivateKeyParameters_initWithShortArray2_withShortArray_withShortArray2_withShortArray_withIntArray_withLibOrgBouncycastlePqcCryptoRainbowLayerArray_(A1inv_, b1_, A2inv_, b2_, vi_, layers_);
  pubKey = new_LibOrgBouncycastlePqcCryptoRainbowRainbowPublicKeyParameters_initWithInt_withShortArray2_withShortArray2_withShortArray_(IOSIntArray_Get(vi_, ((IOSIntArray *) nil_chk(vi_))->size_ - 1) - IOSIntArray_Get(vi_, 0), pub_quadratic_, pub_singular_, pub_scalar_);
  return new_LibOrgBouncycastleCryptoAsymmetricCipherKeyPair_initWithLibOrgBouncycastleCryptoParamsAsymmetricKeyParameter_withLibOrgBouncycastleCryptoParamsAsymmetricKeyParameter_(pubKey, privKey);
}

- (void)initialize__WithLibOrgBouncycastleCryptoKeyGenerationParameters:(LibOrgBouncycastleCryptoKeyGenerationParameters *)param {
  self->rainbowParams_ = (LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *) cast_chk(param, [LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters class]);
  self->sr_ = [((LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *) nil_chk(rainbowParams_)) getRandom];
  self->vi_ = [((LibOrgBouncycastlePqcCryptoRainbowRainbowParameters *) nil_chk([((LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *) nil_chk(self->rainbowParams_)) getParameters])) getVi];
  self->numOfLayers_ = [((LibOrgBouncycastlePqcCryptoRainbowRainbowParameters *) nil_chk([((LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *) nil_chk(self->rainbowParams_)) getParameters])) getNumOfLayers];
  self->initialized_ = true;
}

- (void)initializeDefault {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_initializeDefault(self);
}

- (void)keygen {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_keygen(self);
}

- (void)generateL1 {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL1(self);
}

- (void)generateL2 {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL2(self);
}

- (void)generateF {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateF(self);
}

- (void)computePublicKey {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_computePublicKey(self);
}

- (void)compactPublicKeyWithShortArray3:(IOSObjectArray *)coeff_quadratic_to_compact {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_compactPublicKeyWithShortArray3_(self, coeff_quadratic_to_compact);
}

- (void)init__WithLibOrgBouncycastleCryptoKeyGenerationParameters:(LibOrgBouncycastleCryptoKeyGenerationParameters *)param {
  [self initialize__WithLibOrgBouncycastleCryptoKeyGenerationParameters:param];
}

- (LibOrgBouncycastleCryptoAsymmetricCipherKeyPair *)generateKeyPair {
  return [self genKeyPair];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastleCryptoAsymmetricCipherKeyPair;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 0, 1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 2, 3, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 4, 1, -1, -1, -1, -1 },
    { NULL, "LLibOrgBouncycastleCryptoAsymmetricCipherKeyPair;", 0x1, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(genKeyPair);
  methods[2].selector = @selector(initialize__WithLibOrgBouncycastleCryptoKeyGenerationParameters:);
  methods[3].selector = @selector(initializeDefault);
  methods[4].selector = @selector(keygen);
  methods[5].selector = @selector(generateL1);
  methods[6].selector = @selector(generateL2);
  methods[7].selector = @selector(generateF);
  methods[8].selector = @selector(computePublicKey);
  methods[9].selector = @selector(compactPublicKeyWithShortArray3:);
  methods[10].selector = @selector(init__WithLibOrgBouncycastleCryptoKeyGenerationParameters:);
  methods[11].selector = @selector(generateKeyPair);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "initialized_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "sr_", "LJavaSecuritySecureRandom;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "rainbowParams_", "LLibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "A1_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "A1inv_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "b1_", "[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "A2_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "A2inv_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "b2_", "[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "numOfLayers_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "layers_", "[LLibOrgBouncycastlePqcCryptoRainbowLayer;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "vi_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "pub_quadratic_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "pub_singular_", "[[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "pub_scalar_", "[S", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "initialize", "LLibOrgBouncycastleCryptoKeyGenerationParameters;", "compactPublicKey", "[[[S", "init" };
  static const J2ObjcClassInfo _LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator = { "RainbowKeyPairGenerator", "lib.org.bouncycastle.pqc.crypto.rainbow", ptrTable, methods, fields, 7, 0x1, 12, 15, -1, -1, -1, -1, -1 };
  return &_LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator;
}

@end

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_init(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  NSObject_init(self);
  self->initialized_ = false;
}

LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *new_LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_init() {
  J2OBJC_NEW_IMPL(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, init)
}

LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *create_LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_init() {
  J2OBJC_CREATE_IMPL(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator, init)
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_initializeDefault(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters *rbKGParams = new_LibOrgBouncycastlePqcCryptoRainbowRainbowKeyGenerationParameters_initWithJavaSecuritySecureRandom_withLibOrgBouncycastlePqcCryptoRainbowRainbowParameters_(LibOrgBouncycastleCryptoCryptoServicesRegistrar_getSecureRandom(), new_LibOrgBouncycastlePqcCryptoRainbowRainbowParameters_init());
  [self initialize__WithLibOrgBouncycastleCryptoKeyGenerationParameters:rbKGParams];
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_keygen(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL1(self);
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL2(self);
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateF(self);
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_computePublicKey(self);
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL1(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  jint dim = IOSIntArray_Get(self->vi_, ((IOSIntArray *) nil_chk(self->vi_))->size_ - 1) - IOSIntArray_Get(self->vi_, 0);
  self->A1_ = [IOSShortArray newArrayWithDimensions:2 lengths:(jint[]){ dim, dim }];
  self->A1inv_ = nil;
  LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField *c = new_LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField_init();
  while (self->A1inv_ == nil) {
    for (jint i = 0; i < dim; i++) {
      for (jint j = 0; j < dim; j++) {
        *IOSShortArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(self->A1_), i)), j) = (jshort) ([((JavaSecuritySecureRandom *) nil_chk(self->sr_)) nextInt] & LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_MASK);
      }
    }
    self->A1inv_ = [c inverseWithShortArray2:self->A1_];
  }
  self->b1_ = [IOSShortArray newArrayWithLength:dim];
  for (jint i = 0; i < dim; i++) {
    *IOSShortArray_GetRef(nil_chk(self->b1_), i) = (jshort) ([((JavaSecuritySecureRandom *) nil_chk(self->sr_)) nextInt] & LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_MASK);
  }
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateL2(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  jint dim = IOSIntArray_Get(self->vi_, ((IOSIntArray *) nil_chk(self->vi_))->size_ - 1);
  self->A2_ = [IOSShortArray newArrayWithDimensions:2 lengths:(jint[]){ dim, dim }];
  self->A2inv_ = nil;
  LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField *c = new_LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField_init();
  while (self->A2inv_ == nil) {
    for (jint i = 0; i < dim; i++) {
      for (jint j = 0; j < dim; j++) {
        *IOSShortArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(self->A2_), i)), j) = (jshort) ([((JavaSecuritySecureRandom *) nil_chk(self->sr_)) nextInt] & LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_MASK);
      }
    }
    self->A2inv_ = [c inverseWithShortArray2:self->A2_];
  }
  self->b2_ = [IOSShortArray newArrayWithLength:dim];
  for (jint i = 0; i < dim; i++) {
    *IOSShortArray_GetRef(nil_chk(self->b2_), i) = (jshort) ([((JavaSecuritySecureRandom *) nil_chk(self->sr_)) nextInt] & LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_MASK);
  }
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_generateF(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  self->layers_ = [IOSObjectArray newArrayWithLength:self->numOfLayers_ type:LibOrgBouncycastlePqcCryptoRainbowLayer_class_()];
  for (jint i = 0; i < self->numOfLayers_; i++) {
    (void) IOSObjectArray_SetAndConsume(nil_chk(self->layers_), i, new_LibOrgBouncycastlePqcCryptoRainbowLayer_initWithInt_withInt_withJavaSecuritySecureRandom_(IOSIntArray_Get(nil_chk(self->vi_), i), IOSIntArray_Get(self->vi_, i + 1), self->sr_));
  }
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_computePublicKey(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self) {
  LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField *c = new_LibOrgBouncycastlePqcCryptoRainbowUtilComputeInField_init();
  jint rows = IOSIntArray_Get(self->vi_, ((IOSIntArray *) nil_chk(self->vi_))->size_ - 1) - IOSIntArray_Get(self->vi_, 0);
  jint vars = IOSIntArray_Get(self->vi_, self->vi_->size_ - 1);
  IOSObjectArray *coeff_quadratic_3dim = [IOSShortArray newArrayWithDimensions:3 lengths:(jint[]){ rows, vars, vars }];
  self->pub_singular_ = [IOSShortArray newArrayWithDimensions:2 lengths:(jint[]){ rows, vars }];
  self->pub_scalar_ = [IOSShortArray newArrayWithLength:rows];
  IOSObjectArray *coeff_alpha;
  IOSObjectArray *coeff_beta;
  IOSObjectArray *coeff_gamma;
  IOSShortArray *coeff_eta;
  jint oils = 0;
  jint vins = 0;
  jint crnt_row = 0;
  IOSShortArray *vect_tmp = [IOSShortArray newArrayWithLength:vars];
  jshort sclr_tmp = 0;
  for (jint l = 0; l < ((IOSObjectArray *) nil_chk(self->layers_))->size_; l++) {
    coeff_alpha = [((LibOrgBouncycastlePqcCryptoRainbowLayer *) nil_chk(IOSObjectArray_Get(self->layers_, l))) getCoeffAlpha];
    coeff_beta = [((LibOrgBouncycastlePqcCryptoRainbowLayer *) nil_chk(IOSObjectArray_Get(nil_chk(self->layers_), l))) getCoeffBeta];
    coeff_gamma = [((LibOrgBouncycastlePqcCryptoRainbowLayer *) nil_chk(IOSObjectArray_Get(nil_chk(self->layers_), l))) getCoeffGamma];
    coeff_eta = [((LibOrgBouncycastlePqcCryptoRainbowLayer *) nil_chk(IOSObjectArray_Get(nil_chk(self->layers_), l))) getCoeffEta];
    oils = ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(nil_chk(coeff_alpha), 0)))->size_;
    vins = ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(nil_chk(coeff_beta), 0)))->size_;
    for (jint p = 0; p < oils; p++) {
      for (jint x1 = 0; x1 < oils; x1++) {
        for (jint x2 = 0; x2 < vins; x2++) {
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_alpha, p)), x1)), x2) withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x1 + vins)];
          (void) IOSObjectArray_Set(coeff_quadratic_3dim, crnt_row + p, [c addSquareMatrixWithShortArray2:IOSObjectArray_Get(coeff_quadratic_3dim, crnt_row + p) withShortArray2:[c multVectsWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x2)]]);
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(self->b2_), x2) withShortArray:vect_tmp];
          (void) IOSObjectArray_Set(nil_chk(self->pub_singular_), crnt_row + p, [c addVectWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(self->pub_singular_, crnt_row + p)]);
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_alpha, p)), x1)), x2) withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x2)];
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(self->b2_), x1 + vins) withShortArray:vect_tmp];
          (void) IOSObjectArray_Set(nil_chk(self->pub_singular_), crnt_row + p, [c addVectWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(self->pub_singular_, crnt_row + p)]);
          sclr_tmp = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_alpha, p)), x1)), x2), IOSShortArray_Get(nil_chk(self->b2_), x1 + vins));
          *IOSShortArray_GetRef(nil_chk(self->pub_scalar_), crnt_row + p) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(self->pub_scalar_, crnt_row + p), LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(sclr_tmp, IOSShortArray_Get(nil_chk(self->b2_), x2)));
        }
      }
      for (jint x1 = 0; x1 < vins; x1++) {
        for (jint x2 = 0; x2 < vins; x2++) {
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_beta, p)), x1)), x2) withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x1)];
          (void) IOSObjectArray_Set(coeff_quadratic_3dim, crnt_row + p, [c addSquareMatrixWithShortArray2:IOSObjectArray_Get(coeff_quadratic_3dim, crnt_row + p) withShortArray2:[c multVectsWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x2)]]);
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(self->b2_), x2) withShortArray:vect_tmp];
          (void) IOSObjectArray_Set(nil_chk(self->pub_singular_), crnt_row + p, [c addVectWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(self->pub_singular_, crnt_row + p)]);
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_beta, p)), x1)), x2) withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), x2)];
          vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(self->b2_), x1) withShortArray:vect_tmp];
          (void) IOSObjectArray_Set(nil_chk(self->pub_singular_), crnt_row + p, [c addVectWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(self->pub_singular_, crnt_row + p)]);
          sclr_tmp = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_beta, p)), x1)), x2), IOSShortArray_Get(nil_chk(self->b2_), x1));
          *IOSShortArray_GetRef(nil_chk(self->pub_scalar_), crnt_row + p) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(self->pub_scalar_, crnt_row + p), LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(sclr_tmp, IOSShortArray_Get(nil_chk(self->b2_), x2)));
        }
      }
      for (jint n = 0; n < vins + oils; n++) {
        vect_tmp = [c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(coeff_gamma), p)), n) withShortArray:IOSObjectArray_Get(nil_chk(self->A2_), n)];
        (void) IOSObjectArray_Set(nil_chk(self->pub_singular_), crnt_row + p, [c addVectWithShortArray:vect_tmp withShortArray:IOSObjectArray_Get(self->pub_singular_, crnt_row + p)]);
        *IOSShortArray_GetRef(nil_chk(self->pub_scalar_), crnt_row + p) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(self->pub_scalar_, crnt_row + p), LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(IOSShortArray_Get(nil_chk(IOSObjectArray_Get(coeff_gamma, p)), n), IOSShortArray_Get(nil_chk(self->b2_), n)));
      }
      *IOSShortArray_GetRef(nil_chk(self->pub_scalar_), crnt_row + p) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(self->pub_scalar_, crnt_row + p), IOSShortArray_Get(nil_chk(coeff_eta), p));
    }
    crnt_row = crnt_row + oils;
  }
  {
    IOSObjectArray *tmp_c_quad = [IOSShortArray newArrayWithDimensions:3 lengths:(jint[]){ rows, vars, vars }];
    IOSObjectArray *tmp_c_sing = [IOSShortArray newArrayWithDimensions:2 lengths:(jint[]){ rows, vars }];
    IOSShortArray *tmp_c_scal = [IOSShortArray newArrayWithLength:rows];
    for (jint r = 0; r < rows; r++) {
      for (jint q = 0; q < ((IOSObjectArray *) nil_chk(self->A1_))->size_; q++) {
        (void) IOSObjectArray_Set(tmp_c_quad, r, [c addSquareMatrixWithShortArray2:IOSObjectArray_Get(tmp_c_quad, r) withShortArray2:[c multMatrixWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(self->A1_, r)), q) withShortArray2:IOSObjectArray_Get(coeff_quadratic_3dim, q)]]);
        (void) IOSObjectArray_Set(tmp_c_sing, r, [c addVectWithShortArray:IOSObjectArray_Get(tmp_c_sing, r) withShortArray:[c multVectWithShort:IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->A1_), r)), q) withShortArray:IOSObjectArray_Get(nil_chk(self->pub_singular_), q)]]);
        *IOSShortArray_GetRef(tmp_c_scal, r) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(tmp_c_scal, r), LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_multElemWithShort_withShort_(IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(self->A1_), r)), q), IOSShortArray_Get(nil_chk(self->pub_scalar_), q)));
      }
      *IOSShortArray_GetRef(tmp_c_scal, r) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(tmp_c_scal, r), IOSShortArray_Get(nil_chk(self->b1_), r));
    }
    coeff_quadratic_3dim = tmp_c_quad;
    self->pub_singular_ = tmp_c_sing;
    self->pub_scalar_ = tmp_c_scal;
  }
  LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_compactPublicKeyWithShortArray3_(self, coeff_quadratic_3dim);
}

void LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator_compactPublicKeyWithShortArray3_(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator *self, IOSObjectArray *coeff_quadratic_to_compact) {
  jint polynomials = ((IOSObjectArray *) nil_chk(coeff_quadratic_to_compact))->size_;
  jint n = ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(coeff_quadratic_to_compact, 0)))->size_;
  jint entries = n * (n + 1) / 2;
  self->pub_quadratic_ = [IOSShortArray newArrayWithDimensions:2 lengths:(jint[]){ polynomials, entries }];
  jint offset = 0;
  for (jint p = 0; p < polynomials; p++) {
    offset = 0;
    for (jint x = 0; x < n; x++) {
      for (jint y = x; y < n; y++) {
        if (y == x) {
          *IOSShortArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(self->pub_quadratic_), p)), offset) = IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_quadratic_to_compact, p)), x)), y);
        }
        else {
          *IOSShortArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(self->pub_quadratic_), p)), offset) = LibOrgBouncycastlePqcCryptoRainbowUtilGF2Field_addElemWithShort_withShort_(IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_quadratic_to_compact, p)), x)), y), IOSShortArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(coeff_quadratic_to_compact, p)), y)), x));
        }
        offset++;
      }
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(LibOrgBouncycastlePqcCryptoRainbowRainbowKeyPairGenerator)
